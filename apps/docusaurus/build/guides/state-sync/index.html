<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-guides/state-sync" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">State Synchronization | Aptos Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aptos.dev/img/meta/og-aptos-docs-default.png"><meta data-rh="true" name="twitter:image" content="https://aptos.dev/img/meta/og-aptos-docs-default.png"><meta data-rh="true" property="og:url" content="https://aptos.dev/guides/state-sync"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="State Synchronization | Aptos Docs"><meta data-rh="true" name="description" content="Aptosネットワーク内のノード(バリデータ、VFN、PFN など)は、常に最新のブロックチェーン状態に同期されている必要があります。各ノードで実行される状態同期(状態同期)コンポーネントが、この役割を負います。状態同期は、ピアから新しいブロックチェーンデータを識別して取得し、データを検証してローカル ストレージに保存します。"><meta data-rh="true" property="og:description" content="Aptosネットワーク内のノード(バリデータ、VFN、PFN など)は、常に最新のブロックチェーン状態に同期されている必要があります。各ノードで実行される状態同期(状態同期)コンポーネントが、この役割を負います。状態同期は、ピアから新しいブロックチェーンデータを識別して取得し、データを検証してローカル ストレージに保存します。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aptos.dev/guides/state-sync"><link data-rh="true" rel="alternate" href="https://aptos.dev/guides/state-sync" hreflang="en"><link data-rh="true" rel="alternate" href="https://aptos.dev/ja/guides/state-sync" hreflang="ja"><link data-rh="true" rel="alternate" href="https://aptos.dev/guides/state-sync" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HM7UY0NMLG-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HVB7QFB9PQ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-HVB7QFB9PQ",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Aptos Docs" href="/opensearch.xml">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/@stoplight/elements@7.7.5/styles.min.css" integrity="sha384-1lLf7J28IOR7k5RlItk6Y+G3hDgVB3y4RCgWNq6ZSwjYfvJXPtZAdW0uklsAZbGW" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.89bf2db0.css">
<script src="/assets/js/runtime~main.65eb5df6.js" defer="defer"></script>
<script src="/assets/js/main.0a39c1ce.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_rfFn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/aptos_word.svg" alt="Aptos Labs Logo" class="themedComponent_iS9h themedComponent--light_Wu9q"><img src="/img/aptos_word_dark.svg" alt="Aptos Labs Logo" class="themedComponent_iS9h themedComponent--dark_ZuQW"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_EebW"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/guides/state-sync" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ja/guides/state-sync" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/aptos-white-paper">Start</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/concepts">Learn about Aptos</a></li><li><a class="dropdown__link" href="/guides/explore-aptos">Explore Aptos</a></li><li><a class="dropdown__link" href="/releases/aptos-releases">Latest Releases</a></li><li><a class="dropdown__link" href="/nodes/networks">Networks</a></li><li><a class="dropdown__link" href="/aptos-white-paper">Read the Aptos White Paper</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/tutorials">Build</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tutorials">Tutorials</a></li><li><a class="dropdown__link" href="/move/move-on-aptos">Learn the Move Language</a></li><li><a class="dropdown__link" href="/standards">Aptos Standards</a></li><li><a class="dropdown__link" href="/apis">Aptos APIs</a></li><li><a class="dropdown__link" href="/sdks/index">Aptos SDKs</a></li><li><a class="dropdown__link" href="/tools/aptos-cli">Aptos CLI</a></li><li><a class="dropdown__link" href="/integration">Integrate with Aptos</a></li><li><a class="dropdown__link" href="/tutorials/build-e2e-dapp/e2e-dapp-index">Build E2E Dapp on Aptos</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/nodes/nodes-landing">Nodes</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/nodes/nodes-landing">Learn about Nodes</a></li><li><a class="dropdown__link" href="/nodes/validator-node/validators">Run a Validator and VFN</a></li><li><a class="dropdown__link" href="/nodes/full-node/public-fullnode">Run a Public Fullnode</a></li><li><a class="dropdown__link" href="/nodes/operations/operations-index">Bootstrap a Node</a></li><li><a class="dropdown__link" href="/nodes/configure/configure-index">Configure a Node</a></li><li><a class="dropdown__link" href="/nodes/measure/measure-index">Monitor a Node</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/nodes/aptos-api-spec">Reference</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/nodes/aptos-api-spec">Aptos REST API Spec</a></li><li><a class="dropdown__link" href="/reference/error-codes">Aptos Errors Codes</a></li><li><a class="dropdown__link" href="/reference/move">Aptos Move Framework</a></li><li><a class="dropdown__link" href="/reference/glossary">Aptos Glossary</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community">Help the Aptos Ecosystem</a></li><li><a class="dropdown__link" href="/community/external-resources">External Resources</a></li><li><a class="dropdown__link" href="/community/site-updates">Update Aptos.dev</a></li><li><a class="dropdown__link" href="/community/aptos-style">Follow Aptos Style</a></li><li><a class="dropdown__link" href="/community/contributors">Contributors</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://learn.aptoslabs.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Learn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_c6F6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/aptos-labs/aptos-developer-discussions/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dev Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_c6F6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_wwMH colorModeToggle_GDDh"><button class="clean-btn toggleButton_faKJ toggleButtonDisabled_aZcY" type="button" disabled="" title="ダークモードを切り替える(現在はダークモード)" aria-label="ダークモードを切り替える(現在はダークモード)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_m8__"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ZVRe"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_g2EE"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_gkQL"><div class="docsWrapper_Qxyk"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sWPH" type="button"></button><div class="docRoot_uKhe"><aside class="theme-doc-sidebar-container docSidebarContainer_Sj9c"><div class="sidebarViewport_Me7G"><div class="sidebar_JlDQ"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_YW1f"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title">Run Nodes</li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/nodes/nodes-landing">Learn about Nodes</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/nodes/validator-node/validators">Run a Validator and VFN</a><button aria-label="Expand sidebar category &#x27;Run a Validator and VFN&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/nodes/full-node/public-fullnode">Run a Public Fullnode</a><button aria-label="Expand sidebar category &#x27;Run a Public Fullnode&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/nodes/operations/operations-index">Bootstrap a Node</a><button aria-label="Expand sidebar category &#x27;Bootstrap a Node&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/nodes/configure/configure-index">Configure a Node</a><button aria-label="Collapse sidebar category &#x27;Configure a Node&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/state-sync">State Synchronization</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/data-pruning">Data Pruning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/reference/telemetry">Telemetry</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/nodes/node-files-all-networks/node-files-index">Locating Node Files</a><button aria-label="Expand sidebar category &#x27;Locating Node Files&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/nodes/measure/measure-index">Monitor a Node</a><button aria-label="Expand sidebar category &#x27;Monitor a Node&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="サイドバーを隠す" aria-label="サイドバーを隠す" class="button button--secondary button--outline collapseSidebarButton_snYO"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_Jf0I"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_fHdE"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_OUYU"><div class="docItemContainer_rlCk"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_A7pt" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_cEG4"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/nodes/configure/configure-index"><span itemprop="name">Configure a Node</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">State Synchronization</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_MUT3 theme-doc-toc-mobile tocMobile_q7HR"><button type="button" class="clean-btn tocCollapsibleButton_gS9W">このページの見出し</button></div><div class="theme-doc-markdown markdown"><h1>状態同期</h1>
<!-- -->
<!-- -->
<p>Aptosネットワーク内のノード(バリデータ、VFN、PFN など)は、常に最新のブロックチェーン状態に同期されている必要があります。各ノードで実行される<a href="https://medium.com/aptoslabs/the-evolution-of-state-sync-the-path-to-100k-transactions-per-second-with-sub-second-latency-at-52e25a2c6f10" target="_blank" rel="noopener noreferrer">状態同期</a>(状態同期)コン ポーネントが、この役割を負います。状態同期は、ピアから新しいブロックチェーンデータを識別して取得し、データを検証してローカル ストレージに保存します。
このドキュメントでは、状態同期の仕組みと設定方法について解説します。</p>
<div class="theme-admonition theme-admonition-danger admonition_xfYw alert alert--danger"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>手動設定</div><div class="admonitionContent_CBOD"><p>殆どのユーザーは状態同期を構成する必要有りません。状態同期は、ノードに最適な構成を自動的に選択します。状態同期は、特定のユースケースがある場合のみ手動で構成する必要があります。
間違った構成を選択すると同期時間が遅くなり、パフォーマンスが低下します。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="状態同期-1">状態同期<a href="#状態同期-1" class="hash-link" aria-label="状態同期 への直接リンク" title="状態同期 への直接リンク">​</a></h2>
<p>大まかに言うと、状態同期は2つの段階で動作します。まず、全てのノードが起動時にブートストラップします(<strong>ブートストラップ段階で</strong>)。これは、ノードがAptosブロックチェーンの最新の状態へ追い付く事を可能とします。次に、ノードは継続して同期する事でブロックチェーンの最新の状態を保ちます(<strong>継続的な同期段階</strong>)。これらの各フェーズには、異なる動作モードがあります。</p>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>急いでノードを開始する必要がありますか?</div><div class="admonitionContent_CBOD"><p>ノードを速く起動する必要がある場合は、以下にネットワークとユースケースの推奨事項が有ります。</p><ul>
<li><strong>Devnet</strong>: ブロックチェーンの履歴全体を同期するには<a href="/guides/state-sync#intelligent-syncing">インテリジェント同期</a>を使用します。
それ以外の場合は<a href="/guides/state-sync#fast-syncing">高速同期</a>を使用します。</li>
<li><strong>テストネット</strong>: ブロックチェーンの履歴全体を同期するには<a href="/nodes/full-node/aptos-db-restore">バックアップ</a>から復元します。それ以外の場合は<a href="/nodes/full-node/bootstrap-fullnode">スナップショット</a>をダウンロードするか<a href="/guides/state-sync#fast-syncing">高速同期</a>を使用します。</li>
<li><strong>メインネット</strong>: ブロックチェーンの履歴全体を同期するには<a href="/nodes/full-node/aptos-db-restore">バックアップ</a>から復元します。それ以外の場合は<a href="/guides/state-sync#fast-syncing">高速同期</a>を使用します。</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="ブートストラップ段階">ブートストラップ段階<a href="#ブートストラップ段階" class="hash-link" aria-label="ブートストラップ段階 への直接リンク" title="ブートストラップ段階 への直接リンク">​</a></h3>
<p>ノードが起動すると、状態同期は構成されたブートストラップモードを使用してブートストラップを実行します。ブートストラップモードはいくつかあります。</p>
<ul>
<li><strong>起源以後の全てのトランザクションを実行します</strong>。 このモードでは、ノードはAptosネットワークから起源以降の全てのトランザクション、つまりブロックチェーンの履歴の開始以後全てのトランザクション
を取得し、それらのトランザクションを再実行します。当然、このモードでは、ネットワークの開始以降の全トランザクションを処理する必要が有るため、最も時間がかかります。</li>
<li><strong>起源以後のトランザクション出力を適用します</strong>。 このモードでは、ノードは起源以降のすべてのトランザクションを取得しますが、トランザクションの再実行をスキップし、代わりに以前バリデータ実行で生成されたトランザクションを出力します。このモードでは、CPU時間の必要量が減少しますが、ネットワークの開始以後の全てのトランザクションが処理されます。</li>
<li><strong>起源以後のインテリジェントな同期</strong>。 このモードではノードは起源以後の全てのトランザクションを取得し、データチャンクごとに、トランザクションを実行するかトランザクションを出力するか、より速い方を行います。これにより、ノードがCPUとネットワークリソースの抑制効率をもっと良くする事が出来ます。このモードは、devnetおよびその他のテスト環境のデフォルトモードです。</li>
<li><strong>高速同期</strong>。 このモードでは、ノードはブロックチェーン内のトランザクション履歴をスキップし、最新のブロックチェーン状態のみを直接ダウンロードします。その結果、ノードはトランザクション履歴データを保持しませんが、迅速にAptosネットワークへ追い付く事が出来ます。このモードは、テストネットとメインネットのデフォルトモードです。</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>デフォルトのブートストラップ?</div><div class="admonitionContent_CBOD"><p>デフォルトのブートストラップモードは、ネットワークの種類によります。</p><ul>
<li><strong>テストネットとメインネット</strong>: デフォルトのブートストラップ モードは高速同期です。なぜなら、これらのネットワークは長期間存続し、大量の履歴データを持っているため。</li>
<li><strong>Devnetとその他のネットワーク</strong>: デフォルトのブートストラップ モードはインテリジェント同期です。なぜなら、これらのネットワークは通常、存続期間が短く、 履歴データの量が少ないため。</li>
</ul></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="継続的な同期段階">継続的な同期段階<a href="#継続的な同期段階" class="hash-link" aria-label="継続的な同期段階 への直接リンク" title="継続的な同期段階 への直接リンク">​</a></h3>
<p>ノードがブートストラップされ、初めAptosネットワークに追いついた後、状態同期は継続的な同期フェーズへ移行し、ブロックチェーンを最新の状態で保ちます。継続的な同期モードにはいくつかあります。</p>
<ul>
<li><strong>トランザクションの実行</strong>。 このモードでは、新しいトランザクションがブロックチェーンにコミットされると、それを実行してノードを最新の状態に保ちます。</li>
<li><strong>トランザクションを出力する</strong>。 このモードでは、トランザクションの実行をスキップし、バリデーター実行によって以前に生成されたトランザクションの出力のみを適用する事で、ノードを最新の状態で保ちます。</li>
<li><strong>インテリジェント同期</strong>.
このモードでは、データチャンクごとに、トランザクションを実行するかトランザクション出力を適用するか、いずれか早い方でノードを最新の状態に保ちます。これにより、ノードはCPUとネットワークリソースを効率良く抑制出来ます。これは、すべての環境のデフォルトモードです。</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>継続的な同期のデフォルト?</div><div class="admonitionContent_CBOD"><p>デフォルトの連続同期モードは常にインテリジェント同期です。このモードが最も効率的なためです。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="状態同期を構成する">状態同期を構成する<a href="#状態同期を構成する" class="hash-link" aria-label="状態同期を構成する への直接リンク" title="状態同期を構成する への直接リンク">​</a></h2>
<p>以下のスニペットは、異なるユースケースでのノードの状態同期を構成する手順を示しています。</p>
<p>これらの構成は、ノードの構成ファイル(例:<code>fullnode.yaml</code>または<code>validator.yaml</code>)へ追加出来ます。</p>
<div class="theme-admonition theme-admonition-danger admonition_xfYw alert alert--danger"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>手動設定</div><div class="admonitionContent_CBOD"><p>状態同期は、特定のユースケースで必要な場合でのみ手動で構成する必要があります。間違った構成を選択すると、同期時間が遅くなりパフォーマンスが低下します。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="全てのトランザクションを実行する">全てのトランザクションを実行する<a href="#全てのトランザクションを実行する" class="hash-link" aria-label="全てのトランザクションを実行する への直接リンク" title="全てのトランザクションを実行する への直接リンク">​</a></h3>
<p>起源以後の全てのトランザクションを実行し、コミットされた新しいトランザクションも引き続き実行するには、ノード構成ファイル(例えば<code>fullnode.yaml</code>もしくは<code>validator.yaml</code>)へ以下を追加します。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">state_sync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">state_sync_driver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">bootstrapping_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ExecuteTransactionsFromGenesis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">continuous_syncing_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ExecuteTransactions</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ノードの同期を確認する</div><div class="admonitionContent_CBOD"><p>ノードが同期している間<a href="/nodes/full-node/verify-pfn"><code>aptos_state_sync_version{type=&quot;synced&quot;}</code></a>メトリックが徐々に増加するのを確認出来ます。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="全トランザクションを出力する">全トランザクションを出力する<a href="#全トランザクションを出力する" class="hash-link" aria-label="全トランザクションを出力する への直接リンク" title="全トランザクションを出力する への直接リンク">​</a></h3>
<p>起源以降の全てのトランザクション出力を適用し、トランザクションがコミットされる度、新しいトランザクション出力を適用し続けるには、ノード構成ファイルへ以下を追加します。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">state_sync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">state_sync_driver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">bootstrapping_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ApplyTransactionOutputsFromGenesis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">continuous_syncing_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ApplyTransactionOutputs</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ノードの同期を確認する</div><div class="admonitionContent_CBOD"><p>ノードが同期している間<a href="/nodes/full-node/verify-pfn"><code>aptos_state_sync_version{type=&quot;synced&quot;}</code></a>メトリックが徐々に増加するのを確認出来ます。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="インテリジェントな同期">インテリジェントな同期<a href="#インテリジェントな同期" class="hash-link" aria-label="インテリジェントな同期 への直接リンク" title="インテリジェントな同期 への直接リンク">​</a></h3>
<p>起源以後の全てのトランザクションと出力を実行または適用するには（そして新しいトランザクションがコミットされても同じことを続けるにはノード構成ファイルへ以下を追加します。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">state_sync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">state_sync_driver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">bootstrapping_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ExecuteOrApplyFromGenesis</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">continuous_syncing_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ExecuteTransactionsOrApplyOutputs</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ノードの同期を確認する</div><div class="admonitionContent_CBOD"><p>ノードが同期している間<a href="/nodes/full-node/verify-pfn"><code>aptos_state_sync_version{type=&quot;synced&quot;}</code></a>メトリックが徐々に増加するのを確認出来ます。</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="高速同期">高速同期<a href="#高速同期" class="hash-link" aria-label="高速同期 への直接リンク" title="高速同期 への直接リンク">​</a></h3>
<div class="theme-admonition theme-admonition-caution admonition_xfYw alert alert--warning"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>慎重に進めて下さい</div><div class="admonitionContent_CBOD"><p>高速同期は、バリデーターとVFNにとって最後の手段としてのみ使用する必要があります。これは、高速同期によってブロックチェーンの履歴がスキップされ、(i)ネットワーク内のデータの可用性が低下する (ブロックチェーンの履歴が高速同期ノードで切り捨てられるため)、(ii)バリデーターのコンセンサスパフォーマンスを妨害する(スキップされたデータが多すぎる場合)ためです。高速同期のバリデーターは、コンセンサスへ参加する資格が無い内は追加の実行時間が必要な場合があります。</p></div></div>
<p>最新のブロックチェーン状態をダウンロードし、コミットされた新しいトランザクションを引き続き処理するには、ノード構成ファイルに以下を追加します。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">state_sync</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">state_sync_driver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">bootstrapping_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> DownloadLatestStates</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">continuous_syncing_mode</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> ExecuteTransactionsOrApplyOutputs</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="theme-admonition theme-admonition-tip admonition_xfYw alert alert--success"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>ノードの同期を確認する</div><div class="admonitionContent_CBOD"><p>ノードが同期している間<code>aptos_state_sync_version{type=&quot;synced_states&quot;}</code>メトリックが徐々に増加して行くのが分かります。但し<code>aptos_state_sync_version{type=&quot;synced&quot;}</code>はノードがブートストラップされた後でのみ増加します。データの量、ネットワーク帯域幅、使用可能なノードリソースによっては、数時間かかる場合があります。</p><p><strong>注:</strong> <code>aptos_state_sync_version{type=&quot;synced_states&quot;}</code>が増加しない場合は、以下の操作を行ってください。</p><ol>
<li>ノード構成ファイルが正しく更新されていることを再度確認してください。</li>
<li>ノードが空のストレージデータベースで起動している事を確認します(以前、状態が同期されていない事)。</li>
</ol></div></div>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="アーカイブpfns">アーカイブPFNs<a href="#アーカイブpfns" class="hash-link" aria-label="アーカイブPFNs への直接リンク" title="アーカイブPFNs への直接リンク">​</a></h2>
<p>アーカイブPFN(ネットワークの開始、つまり起源以後の全ブロックチェーンデータを含むPFN)を操作するには、以下を行う必要が有ります。</p>
<ol>
<li>PFNがブートストラップモードとして高速同期を<strong>使用していない</strong>ことを確認して下さい。高速同期ではトランザクション履歴がスキップされます。
そのかわり、起源から同期するモード(例: ジェネシスからのインテリジェント同期)を使用して下さい。</li>
<li><a href="/guides/data-pruning#disable-the-ledger-pruner">データ削除ドキュメント</a>の解説に従い、台帳プルーナーを無効にします。
これにより、データが削除されず、PFNは全ブロックチェーンデータを含みます。</li>
</ol>
<p>以下2つの手順を同時に実行する事で、PFNは作成以降のすべてのデータを取得し、データを削除する事無く同期を継続出来ます。</p>
<div class="theme-admonition theme-admonition-danger admonition_xfYw alert alert--danger"><div class="admonitionHeading_V4B4"><span class="admonitionIcon_EG4P"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>アーカイブノードは廃止されました。</div><div class="admonitionContent_CBOD"><p>アーカイブノードの実行と維持は高価で、時間がかかります。これは、ノードへ保存されるデータの量が際限なく増加するためです。そのため、アーカイブノードは公式に 廃止されました。ブロックチェーンの履歴全体を保存して維持したい場合は<a href="/indexer/indexer-landing">インデクサー</a>を使用する事をお勧めします。</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="セキュリティの影響とデータの整合性">セキュリティの影響とデータの整合性<a href="#セキュリティの影響とデータの整合性" class="hash-link" aria-label="セキュリティの影響とデータの整合性 への直接リンク" title="セキュリティの影響とデータの整合性 への直接リンク">​</a></h2>
<p>各異なる状態同期モードでは、ノードと同期されているデータが正しく生成され、検証者によって署名されている事を確認するため、データ整合性検証が実行されます。これは同期モードごとに若干異なって発生します。</p>
<ol>
<li><strong>トランザクションの実行</strong>: 起源からのトランザクションの実行は、最も安全な同期モードです。これは、開始時からの全てのトランザクションがコンセンサスによって正しく合意され、全てのトランザクションがバリデータによって正しく実行された事を検証します。結果生じる全てのブロックチェーンの状態は、同期ノードによって再検証されます。</li>
<li><strong>トランザクションを出力する</strong>: 起源からのトランザクションの出力は、全てのトランザクションの実行より高速ですが、同期ノードはバリデーターがトランザクションを正しく実行したことを信頼する必要があります。ただし、その他のすべてのブロックチェーン状態は手動で再検証されます。例えば、コンセンサスメッセージ、トランザクション履歴、状態ハッシュなどは検証されます。</li>
<li><strong>インテリジェント同期</strong>: インテリジェント同期は、データチャンクごとに、トランザクション出力を実行か適用のどちらか速い方を行います。従って、このモードを使用する場合のセキュリティの影響は、トランザクションを出力する場合と同じです。</li>
<li><strong>高速同期</strong>: 高速同期では、トランザクション履歴をスキップし、継続的に同期する前に最新のブロックチェーン状態をダウンロードします。これを行うには、同期ノードが、トランザクション履歴内のすべてのトランザクションについてバリデータが正しく合意した事を信頼し、バリデータによって全てのトランザクションが正しく実行された事を信頼する必要があります。ただし、その他のすべてのブロックチェーン状態は手動で再検証する必要が有ります。（例えば、エポックの変更やその結果のブロックチェーン状態など）</li>
</ol>
<p>全ての同期モードは、バリデータセットから信頼のルートを取得し、ブロックチェーンデータ上のバリデータから暗号署名を取得します。</p>
<p>この仕組みの詳細は<a href="https://medium.com/aptoslabs/the-evolution-of-state-sync-the-path-to-100k-transactions-per-second-with-sub-second-latency-at-52e25a2c6f10" target="_blank" rel="noopener noreferrer">状態同期のブログ投稿</a>を御覧下さい。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/guides/state-sync.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_l3kn" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このページを編集</a></div><div class="col lastUpdated_nZMy"><span class="theme-last-updated"><b><time datetime="2024-06-02T10:33:58.000Z">2024年6月2日</time></b>に<!-- -->最終更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/nodes/configure/configure-index"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">Configure a Node</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/guides/data-pruning"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">Data Pruning</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_HHZg thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#状態同期-1" class="table-of-contents__link toc-highlight">状態同期</a><ul><li><a href="#ブートストラップ段階" class="table-of-contents__link toc-highlight">ブートストラップ段階</a></li><li><a href="#継続的な同期段階" class="table-of-contents__link toc-highlight">継続的な同期段階</a></li></ul></li><li><a href="#状態同期を構成する" class="table-of-contents__link toc-highlight">状態同期を構成する</a><ul><li><a href="#全てのトランザクションを実行する" class="table-of-contents__link toc-highlight">全てのトランザクションを実行する</a></li><li><a href="#全トランザクションを出力する" class="table-of-contents__link toc-highlight">全トランザクションを出力する</a></li><li><a href="#インテリジェントな同期" class="table-of-contents__link toc-highlight">インテリジェントな同期</a></li><li><a href="#高速同期" class="table-of-contents__link toc-highlight">高速同期</a></li></ul></li><li><a href="#アーカイブpfns" class="table-of-contents__link toc-highlight">アーカイブPFNs</a></li><li><a href="#セキュリティの影響とデータの整合性" class="table-of-contents__link toc-highlight">セキュリティの影響とデータの整合性</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-left">
                  <a class="footer-logo" href="https://aptosfoundation.org" target="_blank" rel="noopener noreferrer" title="Aptos Foundation">
                    <svg width="100%" height="100%" version="1.2" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 112 112" overflow="visible" xml:space="preserve"><path fill="currentColor" d="M86.6 37.4h-9.9c-1.1 0-2.2-.5-3-1.3l-4-4.5c-1.2-1.3-3.1-1.4-4.5-.3l-.3.3-3.4 3.9c-1.1 1.3-2.8 2-4.5 2H2.9C1.4 41.9.4 46.6 0 51.3h51.2c.9 0 1.8-.4 2.4-1l4.8-5c.6-.6 1.4-1 2.3-1h.2c.9 0 1.8.4 2.4 1.1l4 4.5c.8.9 1.9 1.4 3 1.4H112c-.4-4.7-1.4-9.4-2.9-13.8H86.6zM53.8 65l-4-4.5c-1.2-1.3-3.1-1.4-4.5-.3l-.3.3-3.5 3.9c-1.1 1.3-2.7 2-4.4 2H.8c.9 4.8 2.5 9.5 4.6 14h25.5c.9 0 1.7-.4 2.4-1l4.8-5c.6-.6 1.4-1 2.3-1h.2c.9 0 1.8.4 2.4 1.1l4 4.5c.8.9 1.9 1.4 3 1.4h56.6c2.1-4.4 3.7-9.1 4.6-14H56.8c-1.2 0-2.3-.5-3-1.4zm19.6-43.6 4.8-5c.6-.6 1.4-1 2.3-1h.2c.9 0 1.8.4 2.4 1l4 4.5c.8.9 1.9 1.3 3 1.3h10.8c-18.8-24.8-54.1-29.7-79-11-4.1 3.1-7.8 6.8-11 11H71c1 .2 1.8-.2 2.4-.8zM34.7 94.2c-1.2 0-2.3-.5-3-1.3l-4-4.5c-1.2-1.3-3.2-1.4-4.5-.2l-.2.2-3.5 3.9c-1.1 1.3-2.7 2-4.4 2h-.2C36 116.9 71.7 118 94.4 96.7c.9-.8 1.7-1.7 2.6-2.6H34.7z"/></svg>
                  </a>
                  <div class="copyright">
                    <p class="copyright-text">© 2024 Aptos Foundation</p>
                    <div class="copyright-links">
                      <a href="https://aptosfoundation.org/privacy" target="_blank">Privacy</a>
                      <a href="https://aptosfoundation.org/terms" target="_blank">Terms</a></div>
                  </div>
                </div>
                </li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                  <p class="right">
                    <nav class="social-links">
                        <a class="social-link" href="https://github.com/aptos-labs/developer-docs" target="_blank" rel="noopener noreferrer" title="Github">
                         <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 0C4.47514 0 0 4.47514 0 10C0 14.4199 2.86679 18.1645 6.83855 19.4905C7.33579 19.5826 7.51995 19.2756 7.51995 19.0055C7.51995 18.7661 7.51381 18.14 7.50767 17.3051C4.72683 17.9067 4.13751 15.9668 4.13751 15.9668C3.68324 14.8128 3.0264 14.5058 3.0264 14.5058C2.11786 13.8858 3.09392 13.8981 3.09392 13.8981C4.09454 13.9718 4.62861 14.9294 4.62861 14.9294C5.51872 16.4579 6.96746 16.016 7.53837 15.7581C7.63045 15.1136 7.88827 14.6716 8.17066 14.4199C5.94843 14.1682 3.61571 13.3088 3.61571 9.47821C3.61571 8.38551 4.00246 7.4954 4.64702 6.79558C4.54266 6.54389 4.19889 5.52486 4.74524 4.14978C4.74524 4.14978 5.58625 3.87968 7.4954 5.17495C8.29343 4.95396 9.14672 4.84346 10 4.83732C10.8471 4.83732 11.7066 4.95396 12.5046 5.17495C14.4137 3.87968 15.2548 4.14978 15.2548 4.14978C15.8011 5.52486 15.4573 6.54389 15.353 6.79558C15.9914 7.4954 16.3781 8.38551 16.3781 9.47821C16.3781 13.3211 14.0393 14.1621 11.8109 14.4137C12.167 14.7207 12.4923 15.3346 12.4923 16.2676C12.4923 17.6059 12.48 18.6802 12.48 19.0117C12.48 19.2818 12.6581 19.5887 13.1676 19.4905C17.1393 18.1645 20 14.4199 20 10.0061C20 4.47514 15.5249 0 10 0Z" fill="currentColor"/></svg>
                        </a>
                        <a class="social-link" href="https://discord.gg/aptosnetwork" target="_blank" rel="noopener noreferrer" title="Discord">
                          <svg width="100%" height="100%" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)"><path d="M60.105 4.898A58.55 58.55 0 0 0 45.653.415a.22.22 0 0 0-.233.11 40.784 40.784 0 0 0-1.8 3.697c-5.456-.817-10.886-.817-16.23 0-.485-1.164-1.201-2.587-1.828-3.697a.228.228 0 0 0-.233-.11 58.386 58.386 0 0 0-14.451 4.483.207.207 0 0 0-.095.082C1.578 18.73-.944 32.144.293 45.39a.244.244 0 0 0 .093.167c6.073 4.46 11.955 7.167 17.729 8.962a.23.23 0 0 0 .249-.082 42.08 42.08 0 0 0 3.627-5.9.225.225 0 0 0-.123-.312 38.772 38.772 0 0 1-5.539-2.64.228.228 0 0 1-.022-.378 31.17 31.17 0 0 0 1.1-.862.22.22 0 0 1 .23-.03c11.619 5.304 24.198 5.304 35.68 0a.219.219 0 0 1 .233.027c.356.293.728.586 1.103.865a.228.228 0 0 1-.02.378 36.384 36.384 0 0 1-5.54 2.637.227.227 0 0 0-.121.315 47.249 47.249 0 0 0 3.624 5.897.225.225 0 0 0 .249.084c5.801-1.794 11.684-4.502 17.757-8.961a.228.228 0 0 0 .092-.164c1.48-15.315-2.48-28.618-10.497-40.412a.18.18 0 0 0-.093-.084Zm-36.38 32.427c-3.497 0-6.38-3.211-6.38-7.156 0-3.944 2.827-7.156 6.38-7.156 3.583 0 6.438 3.24 6.382 7.156 0 3.945-2.827 7.156-6.381 7.156Zm23.593 0c-3.498 0-6.38-3.211-6.38-7.156 0-3.944 2.826-7.156 6.38-7.156 3.582 0 6.437 3.24 6.38 7.156 0 3.945-2.798 7.156-6.38 7.156Z" fill="currentColor"/></g><defs><clipPath id="a"><path fill="currentColor" d="M0 0h71v55H0z"/></clipPath></defs></svg>
                        </a>
                        <a class="social-link" href="https://twitter.com/Aptos" target="_blank" rel="noopener noreferrer" title="Twitter">
                          <svg width="100%" height="100%" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M22 2.013a9.395 9.395 0 0 1-2.593.676A4.348 4.348 0 0 0 21.392.314a9.341 9.341 0 0 1-2.866 1.042A4.62 4.62 0 0 0 15.232 0c-2.493 0-4.514 1.922-4.514 4.292 0 .336.04.664.117.978C7.083 5.09 3.758 3.382 1.532.786A4.115 4.115 0 0 0 .92 2.944c0 1.489.796 2.802 2.007 3.571A4.669 4.669 0 0 1 .884 5.98v.053c0 2.08 1.555 3.815 3.62 4.209a4.744 4.744 0 0 1-2.038.074c.574 1.705 2.241 2.945 4.216 2.98a9.358 9.358 0 0 1-5.605 1.837c-.365 0-.724-.02-1.077-.06A13.257 13.257 0 0 0 6.918 17c8.303 0 12.843-6.54 12.843-12.21 0-.187-.004-.372-.013-.556A8.929 8.929 0 0 0 22 2.013Z" fill="currentColor"/></svg>
                        </a>
                    </nav>
                  </p>
              </li></ul></div></div></div></footer></div>
</body>
</html>