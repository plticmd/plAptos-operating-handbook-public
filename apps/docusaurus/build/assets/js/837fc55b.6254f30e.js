"use strict";(self.webpackChunkaptos_docs=self.webpackChunkaptos_docs||[]).push([[2626],{78157:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>i,contentTitle:()=>r,default:()=>j,frontMatter:()=>c,metadata:()=>a,toc:()=>d});var o=t(63159),s=t(83581);const c={title:"Using objects"},r="Using objects",a={id:"move/move-on-aptos/objects/using-objects",title:"Using objects",description:"Using an object as an entry function argument",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/move/move-on-aptos/objects/using-objects.md",sourceDirName:"move/move-on-aptos/objects",slug:"/move/move-on-aptos/objects/using-objects",permalink:"/move/move-on-aptos/objects/using-objects",draft:!1,unlisted:!1,editUrl:"https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/move/move-on-aptos/objects/using-objects.md",tags:[],version:"current",lastUpdatedAt:1713276994,formattedLastUpdatedAt:"2024\u5e744\u670816\u65e5",frontMatter:{title:"Using objects"},sidebar:"appSidebar",previous:{title:"Configuring objects",permalink:"/move/move-on-aptos/objects/configuring-objects"},next:{title:"Building with Move Scripts",permalink:"/move/move-on-aptos/scripts/"}},i={},d=[{value:"Using an object as an entry function argument",id:"using-an-object-as-an-entry-function-argument",level:2},{value:"Looking up ownership",id:"looking-up-ownership",level:2},{value:"Transfer of ownership",id:"transfer-of-ownership",level:2},{value:"Deleting",id:"deleting",level:2},{value:"Burning",id:"burning",level:2},{value:"Example contracts",id:"example-contracts",level:2}];function l(e){const n={a:"a",br:"br",code:"code",h1:"h1",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(n.h1,{id:"using-objects",children:"Using objects"}),"\n",(0,o.jsx)(n.h2,{id:"using-an-object-as-an-entry-function-argument",children:"Using an object as an entry function argument"}),"\n",(0,o.jsxs)(n.p,{children:[(0,o.jsx)(n.code,{children:"0x1::object::Object<T>"})," can be used as an input argument to an entry function.\nIt's encoded as the ",(0,o.jsx)(n.code,{children:"address"})," of the object, and type checked to the value\nin ",(0,o.jsx)(n.code,{children:"T"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["For more generic functions, this can be handled as providing a generic ",(0,o.jsx)(n.code,{children:"T"})," for\ntyping the input:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::Object;\n\n  /// This will fail of the object doesn't have the generic `T` stored\n  entry fun do_something<T>(object: Object<T>) {\n    // ...\n  }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"Additionally, the individual resources that are at the object can be used. The\nresource will be checked for existence before the function executes."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::Object;\n\n  struct MyAwesomeStruct has key {}\n\n  /// This will fail if the object doesn't have MyAwesomeStruct stored\n  entry fun do_something(object: Object<MyAwesomeStruct>) {\n    // ...\n  }\n}\n"})}),"\n",(0,o.jsxs)(n.p,{children:["The resource ",(0,o.jsx)(n.code,{children:"0x1::object::ObjectCore"})," is available for all objects"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::{Object, ObjectCore};\n\n  /// This will only fail of the address is not an object\n  entry fun do_something(object: Object<ObjectCore>) {\n    // ...\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h1,{id:"object-types",children:"Object Types"}),"\n",(0,o.jsx)(n.p,{children:"Objects can store multiple resources at their address, and you can refer to an\nObject by any of those types. You can convert an address to an object, or\nconvert\nan object between types as long as the resource is available."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::{self, Object, ObjectCore};\n\n  struct MyAwesomeStruct has key {}\n\n  fun convert_type(object: Object<ObjectCore>): Object<MyAwesomeStruct> {\n    object::convert<MyAwesomeStruct>(object)\n  }\n\n  fun address_to_type(object_address: address): Object<MyAwesomeStruct> {\n    object::address_to_object<MyAwesomeStruct>(object)\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h1,{id:"object-ownership",children:"Object ownership"}),"\n",(0,o.jsx)(n.p,{children:"Objects can be owned by any address, this includes Objects, Accounts, and\nResource\naccounts. This allows composability between objects, as well as complex\nrelationships\nbetween objects."}),"\n",(0,o.jsx)(n.h2,{id:"looking-up-ownership",children:"Looking up ownership"}),"\n",(0,o.jsx)(n.p,{children:"Ownership can be found by a few methods:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use std::signer;\n  use aptos_framework::object::{self, Object};\n\n  // Not authorized!\n  const E_NOT_AUTHORIZED: u64 = 1;\n\n  fun check_owner_is_caller<T>(caller: &signer, object: Object<T>) {\n    assert!(\n      object::is_owner(object, signer::address_of(caller)),\n      E_NOT_AUTHORIZED\n    );\n  }\n\n  fun check_is_owner_of_object<T>(addr: address, object: Object<T>) {\n    assert!(object::owner(object) == addr, E_NOT_AUTHORIZED);\n  }\n\n  fun check_is_nested_owner_of_object<T, U>(\n    caller: &signer,\n    outside_object: Object<T>,\n    inside_object: Object<U>\n  ) {\n    // Ownership expected\n    // Caller account -> Outside object -> inside object\n\n    // Check outside object owns inside object\n    let outside_address = object::object_address(outside_object);\n    assert!(object::owns(inside_object, outside_address), E_NOT_AUTHORIZED);\n\n    // Check that the caller owns the outside object\n    let caller_address = signer::address_of(caller);\n    assert!(object::owns(outside_object, caller_address), E_NOT_AUTHORIZED);\n\n    // Check that the caller owns the inside object (via the outside object)\n    // This can skip the first two calls (and even more nested)\n    assert!(object::owns(inside_object, caller_address), E_NOT_AUTHORIZED);\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"transfer-of-ownership",children:"Transfer of ownership"}),"\n",(0,o.jsxs)(n.p,{children:["An object can be transferred as long as ungated transfer has not been\ndisabled.",(0,o.jsx)(n.br,{}),"\n","See ",(0,o.jsx)(n.a,{href:"/move/move-on-aptos/objects/configuring-objects#disabling-or-re-enabling-transfers",children:"disabling transfer of an object"}),"."]}),"\n",(0,o.jsxs)(n.p,{children:["If the ungated transfer is disabled, only transfers can be done with\na ",(0,o.jsx)(n.code,{children:"TransferRef"})," or a ",(0,o.jsx)(n.code,{children:"LinearTransferRef"}),". When ungated transfers are enabled,\nobjects can be transferred as follows:"]}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::{self, Object};\n\n  /// Transfer to another address, this can be an object or account\n  fun transfer<T>(owner: &signer, object: Object<T>, destination: address) {\n    object::transfer(owner, object, destination);\n  }\n\n  /// Transfer to another object\n  fun transfer_to_object<T, U>(\n    owner: &signer,\n    object: Object<T>,\n    destination: Object<U>\n  ) {\n    object::transfer_to_object(owner, object, destination);\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h1,{id:"deleting-or-burning-objects",children:"Deleting or Burning objects"}),"\n",(0,o.jsx)(n.p,{children:"There are two ways to remove an object:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Delete"}),"\n",(0,o.jsx)(n.li,{children:"Burn"}),"\n"]}),"\n",(0,o.jsx)(n.h2,{id:"deleting",children:"Deleting"}),"\n",(0,o.jsxs)(n.p,{children:["To delete an object, the user must have a ",(0,o.jsx)(n.code,{children:"DeleteRef"}),"\nsee ",(0,o.jsx)(n.a,{href:"/move/move-on-aptos/objects/configuring-objects#allowing-deletion-of-an-object",children:"allowing deletion of an object"}),"."]}),"\n",(0,o.jsx)(n.h2,{id:"burning",children:"Burning"}),"\n",(0,o.jsx)(n.p,{children:"However, if the object is not deletable, you can tombstone and burn the unwanted\nobject."}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::{self, Object};\n\n  fun burn_object<T>(owner: &signer, object: Object<T>) {\n    object::burn(owner, object);\n    assert!(object::is_burnt(object) == true, 1);\n  }\n}\n"})}),"\n",(0,o.jsx)(n.p,{children:"If a user decided that they did not want to burn it, they can un-burn it"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-move",children:"module my_addr::object_playground {\n  use aptos_framework::object::{self, Object};\n\n  fun unburn_object<T>(owner: &signer, object: object::Object<T>) {\n    object::unburn(owner, object);\n    assert!(object::is_burnt(object) == false, 1);\n  }\n}\n"})}),"\n",(0,o.jsx)(n.h2,{id:"example-contracts",children:"Example contracts"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-core/tree/main/aptos-move/move-examples/marketplace",children:"Digital Asset Marketplace Example"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-core/tree/main/aptos-move/move-examples/token_objects",children:"Digital Assets Examples"})}),"\n",(0,o.jsx)(n.li,{children:(0,o.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-core/tree/main/aptos-move/move-examples/fungible_asset",children:"Fungible Asset Examples"})}),"\n"]})]})}function j(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(l,{...e})}):l(e)}},83581:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var o=t(11855);const s={},c=o.createContext(s);function r(e){const n=o.useContext(c);return o.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(c.Provider,{value:n},e.children)}}}]);