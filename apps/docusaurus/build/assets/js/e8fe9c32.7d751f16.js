"use strict";(self.webpackChunkaptos_docs=self.webpackChunkaptos_docs||[]).push([[2440],{45822:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>s,default:()=>u,frontMatter:()=>a,metadata:()=>i,toc:()=>c});var t=o(63159),r=o(83581);const a={title:"Use Aptos CLI with Ledger",id:"use-aptos-ledger"},s="Use the Aptos CLI with Ledger",i={id:"tools/aptos-cli/use-cli/use-aptos-ledger",title:"Use Aptos CLI with Ledger",description:"The aptos tool can be used with your Ledger device to sign any transaction. This is the most secure way to sign transactions, as your private key never leaves your device.",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/tools/aptos-cli/use-cli/use-aptos-ledger.md",sourceDirName:"tools/aptos-cli/use-cli",slug:"/tools/aptos-cli/use-cli/use-aptos-ledger",permalink:"/tools/aptos-cli/use-cli/use-aptos-ledger",draft:!1,unlisted:!1,editUrl:"https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/tools/aptos-cli/use-cli/use-aptos-ledger.md",tags:[],version:"current",lastUpdatedAt:1713276994,formattedLastUpdatedAt:"2024\u5e744\u670816\u65e5",frontMatter:{title:"Use Aptos CLI with Ledger",id:"use-aptos-ledger"},sidebar:"appSidebar",previous:{title:"Genesis",permalink:"/tools/aptos-cli/use-cli/cli-genesis"},next:{title:"Running a Local Network",permalink:"/tools/aptos-cli/use-cli/running-a-local-network"}},d={},c=[{value:"Blind Signing",id:"blind-signing",level:2},{value:"Create a new Ledger profile",id:"create-a-new-ledger-profile",level:2},{value:"Publish a package with Ledger",id:"publish-a-package-with-ledger",level:2},{value:"Common Errors",id:"common-errors",level:2},{value:"Error: Wrong raw transaction length",id:"error-wrong-raw-transaction-length",level:3},{value:"Error: Ledger device is locked",id:"error-ledger-device-is-locked",level:3}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"use-the-aptos-cli-with-ledger",children:"Use the Aptos CLI with Ledger"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"aptos"})," tool can be used with your Ledger device to sign any transaction. This is the most secure way to sign transactions, as your private key never leaves your device."]}),"\n",(0,t.jsxs)(n.p,{children:["NOTE: It is highly recommended to use ",(0,t.jsx)(n.code,{children:"Ledger Nano S Plus"})," or ",(0,t.jsx)(n.code,{children:"Ledger Nano X"})," devices. The ",(0,t.jsx)(n.code,{children:"Ledger Nano S"})," device has very limited memory and may not be able to sign most of the transactions. If you are trying to sign a transaction that is too big for your device to handle, you will get an error ",(0,t.jsx)(n.code,{children:"Wrong raw transaction length"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"blind-signing",children:"Blind Signing"}),"\n",(0,t.jsxs)(n.p,{children:["Before you begin, make sure you have ",(0,t.jsx)(n.code,{children:"Blind Signing"})," enabled on your Ledger device. Otherwise, you will not be able to sign transactions.\n",(0,t.jsx)(n.code,{children:"Blind Signing"})," - confirming a smart contract interaction you can\u2019t verify through a human-readable language."]}),"\n",(0,t.jsx)(n.h2,{id:"create-a-new-ledger-profile",children:"Create a new Ledger profile"}),"\n",(0,t.jsx)(n.p,{children:"In order to interact with your Ledger device, you must first create a new profile. This profile will be used to store your Ledger public key, and will be used to sign transactions."}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"$ aptos init --profile myprofile --ledger\nConfiguring for profile myprofile\nChoose network from [devnet, testnet, mainnet, local, custom | defaults to devnet]\n\nNo network given, using devnet...\nPlease choose an index from the following 5 ledger accounts, or choose an arbitrary index that you want to use:\n[0] Derivation path: m/44'/637'/0'/0'/0' (Address: 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb)\n[1] Derivation path: m/44'/637'/1'/0'/0' (Address: 21563230cf6d69ee72a51d21920430d844ee48235e708edbafbc69708075a86e)\n[2] Derivation path: m/44'/637'/2'/0'/0' (Address: 667446181b3b980ef29f5145a7a2cc34d433fc3ee8c97fc044fd978435f2cb8d)\n[3] Derivation path: m/44'/637'/3'/0'/0' (Address: 2dcf037a9f31d93e202c074229a1b69ea8ee4d2f2d63323476001c65b0ec4f31)\n[4] Derivation path: m/44'/637'/4'/0'/0' (Address: 23c579a9bdde1a59f1c9d36d8d379aeefe7a5997b5b58bd5a5b0c12a4f170431)\n0\nAccount 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb has been already found on-chain\n\n---\nAptos CLI is now set up for account 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb as profile myprofile!  Run `aptos --help` for more information about commands\n{\n  \"Result\": \"Success\"\n}\n"})}),"\n",(0,t.jsxs)(n.p,{children:["In the above, we have created a new profile called ",(0,t.jsx)(n.code,{children:"myprofile"})," and have chosen to use the first Ledger account (index 0) to sign transactions. If there is a certain index account you would like to use, you are welcome to use it."]}),"\n",(0,t.jsxs)(n.p,{children:["After the above command, a new profile will be created in ",(0,t.jsx)(n.code,{children:"~/.aptos/config.yml"})," and will look like the following:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'myprofile:\n  public_key: "0x05a8ace09d1136181029be3e817de3619562b0da2eedbff210e2b2f92c71be70"\n  account: 59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb\n  rest_url: "https://api.devnet.aptoslabs.com"\n  faucet_url: "https://faucet.devnet.aptoslabs.com"\n  derivation_path: "m/44\'/637\'/0\'/0\'/0\'"\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Notice that the above stores the derivation path instead of private key. This is because the private key is stored on your Ledger device, and is never exposed to the ",(0,t.jsx)(n.code,{children:"aptos"})," tool."]}),"\n",(0,t.jsx)(n.h2,{id:"publish-a-package-with-ledger",children:"Publish a package with Ledger"}),"\n",(0,t.jsxs)(n.p,{children:["Once you have created a profile, you can use it to publish a package. The ",(0,t.jsx)(n.code,{children:"aptos"})," tool will prompt you to confirm the transaction on your Ledger device.\nNote: Make sure that you are on the same directory as where your move module is located:"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'$ aptos move publish --profile myprofile --named-addresses hello_blockchain=myprofile\nCompiling, may take a little while to download git dependencies...\nINCLUDING DEPENDENCY AptosFramework\nINCLUDING DEPENDENCY AptosStdlib\nINCLUDING DEPENDENCY MoveStdlib\nBUILDING Examples\npackage size 1755 bytes\nDo you want to submit a transaction for a range of [139600 - 209400] Octas at a gas unit price of 100 Octas? [yes/no] >\nyes\n{\n  "Result": {\n    "transaction_hash": "0xd5a12594f85284cfd5518d547d084030b178ee926fa3d8cbf699cc0596eff538",\n    "gas_used": 1396,\n    "gas_unit_price": 100,\n    "sender": "59836ba1dd0c845713bdab34346688d6f1dba290dbf677929f2fc20593ba0cfb",\n    "sequence_number": 0,\n    "success": true,\n    "timestamp_us": 1689887104333038,\n    "version": 126445,\n    "vm_status": "Executed successfully"\n  }\n}\n'})}),"\n",(0,t.jsxs)(n.p,{children:["After the above command, you will be prompted to confirm the transaction on your Ledger device. Once you confirm, the transaction will be submitted to the network. Note: Make sure you have ",(0,t.jsx)(n.code,{children:"Blind Signing"})," enabled on your Ledger device. Otherwise, you will not be able to sign transactions.\n",(0,t.jsx)(n.code,{children:"Blind Signing"})," - confirming a smart contract interaction you can\u2019t verify through a human-readable language."]}),"\n",(0,t.jsx)(n.h2,{id:"common-errors",children:"Common Errors"}),"\n",(0,t.jsx)(n.h3,{id:"error-wrong-raw-transaction-length",children:"Error: Wrong raw transaction length"}),"\n",(0,t.jsxs)(n.p,{children:["Your raw transaction or package size is too big. Currently, the Aptos ledger app can only support up to 20kb transaction. If you are using a ",(0,t.jsx)(n.code,{children:"Ledger Nano S"}),", the supported transaction size will be even smaller."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'{\n  "Error": "Unexpected error: Error - Wrong raw transaction length"\n}\n'})}),"\n",(0,t.jsx)(n.h3,{id:"error-ledger-device-is-locked",children:"Error: Ledger device is locked"}),"\n",(0,t.jsx)(n.p,{children:"Make sure your Ledger device is unlocked and you have Aptos app opened"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:'{\n  "Error": "Unexpected error: Error - Ledger device is locked"\n}\n'})})]})}function u(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},83581:(e,n,o)=>{o.d(n,{R:()=>s,x:()=>i});var t=o(11855);const r={},a=t.createContext(r);function s(e){const n=t.useContext(a);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function i(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),t.createElement(a.Provider,{value:n},e.children)}}}]);