"use strict";(self.webpackChunkaptos_docs=self.webpackChunkaptos_docs||[]).push([[4676],{1409:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>u,frontMatter:()=>i,metadata:()=>l,toc:()=>c});var t=o(63159),s=o(83581);const i={title:"Using Source Code",slug:"deploy-a-pfn-source-code"},d="Deploy a PFN using Source Code",l={id:"nodes/full-node/deployments/using-source-code",title:"Using Source Code",description:"To deploy a PFN using the aptos-core source code, first, see Building Aptos From Source for instructions",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/nodes/full-node/deployments/using-source-code.md",sourceDirName:"nodes/full-node/deployments",slug:"/nodes/full-node/deployments/deploy-a-pfn-source-code",permalink:"/nodes/full-node/deployments/deploy-a-pfn-source-code",draft:!1,unlisted:!1,editUrl:"https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/nodes/full-node/deployments/using-source-code.md",tags:[],version:"current",lastUpdatedAt:1713276994,formattedLastUpdatedAt:"2024\u5e744\u670816\u65e5",frontMatter:{title:"Using Source Code",slug:"deploy-a-pfn-source-code"},sidebar:"nodeSidebar",previous:{title:"Deploy a PFN",permalink:"/nodes/full-node/deployments/deploy-a-pfn"},next:{title:"Using Docker",permalink:"/nodes/full-node/deployments/deploy-a-pfn-docker"}},r={},c=[];function a(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"deploy-a-pfn-using-source-code",children:"Deploy a PFN using Source Code"}),"\n",(0,t.jsxs)(n.p,{children:["To deploy a PFN using the ",(0,t.jsx)(n.code,{children:"aptos-core"})," source code, first, see ",(0,t.jsx)(n.a,{href:"/guides/building-from-source",children:"Building Aptos From Source"})," for instructions\non how to download the ",(0,t.jsx)(n.code,{children:"aptos-core"})," repository and build the binary. Then, follow the steps below:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Make sure your current working directory is ",(0,t.jsx)(n.code,{children:"aptos-core"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Check out the ",(0,t.jsx)(n.code,{children:"mainnet"})," branch using ",(0,t.jsx)(n.code,{children:"git checkout --track origin/mainnet"}),"; remember, you may instead use ",(0,t.jsx)(n.code,{children:"devnet"})," or ",(0,t.jsx)(n.code,{children:"testnet"}),"\nif you wish to run your PFN in a different network."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Next, download the ",(0,t.jsx)(n.code,{children:"genesis.blob"})," and ",(0,t.jsx)(n.code,{children:"waypoint.txt"})," files for the network your PFN will connect to:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Run this command to download the genesis blob (for mainnet):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -O https://raw.githubusercontent.com/aptos-labs/aptos-networks/main/mainnet/genesis.blob\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Run this command to download the waypoint file (for mainnet):"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"curl -O https://raw.githubusercontent.com/aptos-labs/aptos-networks/main/mainnet/waypoint.txt\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{title:"Don't want to connect to mainnet?",type:"caution",children:(0,t.jsxs)(n.p,{children:["To connect to other networks (e.g., ",(0,t.jsx)(n.code,{children:"devnet"})," and ",(0,t.jsx)(n.code,{children:"testnet"}),"), you can find the genesis and waypoint here \u279c ",(0,t.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-networks",children:"https://github.com/aptos-labs/aptos-networks"}),".\nBe sure to download the ",(0,t.jsx)(n.code,{children:"genesis.blob"})," and ",(0,t.jsx)(n.code,{children:"waypoint.txt"})," for those networks, instead of using the genesis\nand waypoint pointed to by the ",(0,t.jsx)(n.code,{children:"curl"})," commands above."]})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Next, run the command below to create a copy of the PFN configuration YAML template:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cp config/src/config/test_data/public_full_node.yaml fullnode.yaml\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Finally, edit the ",(0,t.jsx)(n.code,{children:"fullnode.yaml"})," configuration file to ensure that your PFN: (i) contains the genesis blob\nand waypoint file you just downloaded; and (ii) saves the synchronized blockchain data to the location of your\nchoice (on your local machine). To do this:"]}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["Specify the correct path to the ",(0,t.jsx)(n.code,{children:"genesis.blob"})," file you just downloaded by editing ",(0,t.jsx)(n.code,{children:"execution.genesis_file_location"})," in the ",(0,t.jsx)(n.code,{children:"fullnode.yaml"})," configuration. By default, it points to ",(0,t.jsx)(n.code,{children:"genesis.blob"})," in the current working directory.","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'execution:\n  genesis_file_location: "./genesis.blob"\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Specify the correct path to the ",(0,t.jsx)(n.code,{children:"waypoint.txt"})," file you just downloaded by editing ",(0,t.jsx)(n.code,{children:"base.waypoint.from_file"})," in the ",(0,t.jsx)(n.code,{children:"fullnode.yaml"})," configuration. By default, it points to ",(0,t.jsx)(n.code,{children:"waypoint.txt"})," in the current working directory. For example:","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'base:\n  waypoint:\n    from_file: "./waypoint.txt"\n'})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["Specify the directory on your local machine that you want to store the blockchain database by editing the ",(0,t.jsx)(n.code,{children:"base.data_dir"})," in the ",(0,t.jsx)(n.code,{children:"fullnode.yaml"})," configuration. For example, you can create a directory ",(0,t.jsx)(n.code,{children:"my-full-node/data"})," in your home directory and specify it as:","\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'base:\n  data_dir: "</path/to/my/homedir/my-full-node/data>"\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Start your local public fullnode by running the below command:"}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"cargo run -p aptos-node --release -- -f ./fullnode.yaml\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Debugging?",type:"tip",children:(0,t.jsxs)(n.p,{children:["The command above will build a release binary for ",(0,t.jsx)(n.code,{children:"aptos-node"})," at: ",(0,t.jsx)(n.code,{children:"aptos-core/target/release/aptos-node"}),". The release\nbinaries tend to be substantially faster than debug binaries but lack debugging information useful for development.\nTo build a debug binary, omit the ",(0,t.jsx)(n.code,{children:"--release"})," flag from the command above."]})}),"\n",(0,t.jsx)(n.p,{children:"You have now successfully configured and started running a PFN in the Aptos mainnet."}),"\n",(0,t.jsx)(n.admonition,{title:"Verify your PFN",type:"tip",children:(0,t.jsxs)(n.p,{children:["If you want to verify that your PFN is running correctly, you can follow the instructions in the ",(0,t.jsx)(n.a,{href:"/nodes/full-node/verify-pfn",children:"Verify a PFN"})," guide."]})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},83581:(e,n,o)=>{o.d(n,{R:()=>d,x:()=>l});var t=o(11855);const s={},i=t.createContext(s);function d(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:d(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);