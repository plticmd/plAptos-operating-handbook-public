"use strict";(self.webpackChunkaptos_docs=self.webpackChunkaptos_docs||[]).push([[3208],{91968:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>i,default:()=>p,frontMatter:()=>t,metadata:()=>c,toc:()=>a});var r=s(63159),o=s(83581);const t={title:"End-to-End\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb"},i="\u30ab\u30b9\u30bf\u30e0\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u4f5c\u6210",c={id:"indexer/custom-processors/e2e-tutorial",title:"End-to-End\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb",description:"\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u57fa\u672c\u7684\u306a\u30ab\u30b9\u30bf\u30e0\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u3092\u4f5c\u6210\u3057Aptos\u30d6\u30ed\u30c3\u30af\u30c1\u30a7\u30fc\u30f3\u4e0a\u306e\u30a4\u30d9\u30f3\u30c8\u3068\u30c7\u30fc\u30bf\u3092\u8ffd\u8de1\u3059\u308b\u624b\u9806\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/indexer/custom-processors/e2e-tutorial.md",sourceDirName:"indexer/custom-processors",slug:"/indexer/custom-processors/e2e-tutorial",permalink:"/indexer/custom-processors/e2e-tutorial",draft:!1,unlisted:!1,editUrl:"https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/indexer/custom-processors/e2e-tutorial.md",tags:[],version:"current",lastUpdatedAt:1713439719,formattedLastUpdatedAt:"2024\u5e744\u670818\u65e5",frontMatter:{title:"End-to-End\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb"},sidebar:"appSidebar",previous:{title:"\u30ab\u30b9\u30bf\u30e0\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc",permalink:"/indexer/custom-processors/"},next:{title:"\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u89e3\u6790",permalink:"/indexer/custom-processors/parsing-txns"}},l={},a=[{value:"\u59cb\u3081\u308b",id:"\u59cb\u3081\u308b",level:2},{value:"\u74b0\u5883\u8a2d\u5b9a",id:"\u74b0\u5883\u8a2d\u5b9a",level:2},{value:"PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u8a2d\u5b9a\u3059\u308b",id:"postgresql\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u8a2d\u5b9a\u3059\u308b",level:3},{value:"Poetry\u3068gRPC\u3067\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3092\u8a2d\u5b9a\u3059\u308b",id:"poetry\u3068grpc\u3067\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3092\u8a2d\u5b9a\u3059\u308b",level:3},{value:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u69cb\u6210",id:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u69cb\u6210",level:2},{value:"config.yaml\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a",id:"configyaml\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a",level:3},{value:"config.yaml\u3092\u66f4\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",id:"configyaml\u3092\u66f4\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",level:3},{value:"\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u3068\u30b9\u30ad\u30fc\u30de\u540d\u3092\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3078\u8ffd\u52a0\u3059\u308b",id:"\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u3068\u30b9\u30ad\u30fc\u30de\u540d\u3092\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3078\u8ffd\u52a0\u3059\u308b",level:3},{value:"Move\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3067\u306e\u30a4\u30d9\u30f3\u30c8\u767a\u884c\u306e\u89e3\u8aac",id:"move\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3067\u306e\u30a4\u30d9\u30f3\u30c8\u767a\u884c\u306e\u89e3\u8aac",level:3},{value:"\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u304c\u3069\u306e\u69d8\u306b\u51fa\u529b\u3001\u51e6\u7406\u3055\u308c\u308b\u306e\u304b\u898b\u3066\u7406\u89e3\u3059\u308b",id:"\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u304c\u3069\u306e\u69d8\u306b\u51fa\u529b\u51e6\u7406\u3055\u308c\u308b\u306e\u304b\u898b\u3066\u7406\u89e3\u3059\u308b",level:3},{value:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e2\u30c7\u30eb\u306e\u4f5c\u6210",id:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e2\u30c7\u30eb\u306e\u4f5c\u6210",level:3},{value:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u5b9f\u884c",id:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u5b9f\u884c",level:2}];function d(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"\u30ab\u30b9\u30bf\u30e0\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u4f5c\u6210",children:"\u30ab\u30b9\u30bf\u30e0\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u4f5c\u6210"}),"\n",(0,r.jsx)(n.p,{children:"\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3067\u306f\u3001\u57fa\u672c\u7684\u306a\u30ab\u30b9\u30bf\u30e0\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u3092\u4f5c\u6210\u3057Aptos\u30d6\u30ed\u30c3\u30af\u30c1\u30a7\u30fc\u30f3\u4e0a\u306e\u30a4\u30d9\u30f3\u30c8\u3068\u30c7\u30fc\u30bf\u3092\u8ffd\u8de1\u3059\u308b\u624b\u9806\u3092\u89e3\u8aac\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u975e\u5e38\u306b\u5358\u7d14\u306a\u30b9\u30de\u30fc\u30c8\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002",(0,r.jsx)(n.strong,{children:"Coin Flip"}),"\u3068\u547c\u3070\u308c\u3066\u3044\u3066\u3001\u3059\u3067\u306b\u30a4\u30d9\u30f3\u30c8\u3092\u767a\u884c\u3057\u3066\u3044\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u30b9\u30de\u30fc\u30c8\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u306f\u3059\u3067\u306b\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u3066\u304a\u308a\u3001\u6539\u9020\u306b\u8208\u5473\u304c\u306a\u3044\u9650\u308a\u6b86\u3069\u306e\u5834\u5408\u3001\u305d\u308c\u3092\u7406\u89e3\u3059\u308b\u5fc5\u8981\u306f\u3042\u308a\u307e\u305b\u3093\u3002"}),"\n",(0,r.jsx)(n.h2,{id:"\u59cb\u3081\u308b",children:"\u59cb\u3081\u308b"}),"\n",(0,r.jsxs)(n.p,{children:["\u307e\u305a\u3001",(0,r.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-indexer-processors",children:"aptos-indexer-processors"}),"\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30af\u30ed\u30fc\u30f3\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"# HTTPS\nhttps://github.com/aptos-labs/aptos-indexer-processors.git\n\n# SSH\ngit@github.com:aptos-labs/aptos-indexer-processors.git\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u30b3\u30a4\u30f3\u30d5\u30ea\u30c3\u30d7\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"cd aptos-indexer-processors\ncd python/processors/coin_flip\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u30d7\u30ed\u30bb\u30c3\u30b5\u306f\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30b9\u30c8\u30ea\u30fc\u30e0\u30b5\u30fc\u30d3\u30b9\u304b\u3089\u306e\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u6d88\u8cbb\u3057\u307e\u3059\u3002Labs-Hosted\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30b9\u30c8\u30ea\u30fc\u30e0\u30b5\u30fc\u30d3\u30b9\u3092\u4f7f\u7528\u3059\u308b\u306b\u306f\u3001\u8a8d\u8a3c\u30c8\u30fc\u30af\u30f3\u304c\u5fc5\u8981\u3067\u3059",(0,r.jsx)(n.a,{href:"/indexer/txn-stream/labs-hosted#authorization-via-api-key",children:"\u3053\u306e\u30ac\u30a4\u30c9"}),"\u306b\u5f93\u3044\u3001\u958b\u767a\u8005\u30dd\u30fc\u30bf\u30eb\u304b\u3089\u30c8\u30fc\u30af\u30f3\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f",(0,r.jsx)(n.code,{children:"Testnet"}),"\u7528\u3067\u3042\u308b\u305f\u3081\u3001",(0,r.jsx)(n.code,{children:"Testnet"}),"\u306eAPI\u30ad\u30fc\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u5b8c\u4e86\u3059\u308b\u3068\u3001\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u30c8\u30fc\u30af\u30f3\u304c\u4f5c\u6210\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"aptoslabs_yj4bocpaKy_Q6RBP4cdBmjA8T51hto1GcVX5ZS9S65dx\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u6b21\u306e\u30c4\u30fc\u30eb\u3082\u5fc5\u8981\u3067\u3059\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:(0,r.jsx)(n.a,{href:"/tools/aptos-cli/install-cli",children:"Aptos CLI"})}),"\n",(0,r.jsxs)(n.li,{children:["Python 3.11+: ",(0,r.jsx)(n.a,{href:"https://docs.python-guide.org/starting/installation/#python-3-installation-guides",children:"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ac\u30a4\u30c9"}),"."]}),"\n",(0,r.jsxs)(n.li,{children:["Poetry: ",(0,r.jsx)(n.a,{href:"https://python-poetry.org/docs/#installation",children:"\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u30ac\u30a4\u30c9"}),"."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306f\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u3057\u3066PostgreSQL\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u4f55\u3092\u4f7f\u7528\u3057\u3066\u3082\u81ea\u7531\u3067\u3059\u304c\u3001\u7c21\u5358\u306b\u3059\u308b\u305f\u3081PostgreSQL\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u4ee5\u4e0b\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u69cb\u6210\u3068\u30c4\u30fc\u30eb\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://www.postgresql.org/download/",children:"PostgreSQL"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.code,{children:"5432"}),"\u30dd\u30fc\u30c8\u306e",(0,r.jsx)(n.code,{children:"localhost"}),"\u3067\u30db\u30b9\u30c8\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f7f\u7528\u3057\u307e\u3059\u3002\u3053\u308c\u304c\u30c7\u30d5\u30a9\u30eb\u30c8\u3067\u3042\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.li,{children:"\u30e6\u30fc\u30b6\u30fc\u540d\u3092\u4f5c\u6210\u3057\u305f\u3089\u3001\u305d\u306e\u30e6\u30fc\u30b6\u30fc\u540d\u3068\u305d\u308c\u306b\u4f7f\u7528\u3059\u308b\u30d1\u30b9\u30ef\u30fc\u30c9\u3092\u8a18\u9332\u3057\u3066\u4e0b\u3055\u3044\u3002"}),"\n",(0,r.jsxs)(n.li,{children:[(0,r.jsx)(n.a,{href:"https://www.digitalocean.com/community/tutorials/how-to-install-postgresql-on-ubuntu-22-04-quickstart",children:"\u3053\u3053"}),"\u3067PostgreSQL\u3068psql\u30c4\u30fc\u30eb\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u53c2\u7167\u3057\u3001\u3088\u308a\u8fc5\u901f\u306b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u8a2d\u5b9a\u51fa\u6765\u307e\u3059\u3002"]}),"\n",(0,r.jsxs)(n.li,{children:["\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u30c7\u30fc\u30bf\u3092\u7c21\u5358\u306b\u8868\u793a\u3059\u308b\u306b\u306f\u3001",(0,r.jsx)(n.a,{href:"https://dbeaver.io/",children:"DBeaver"}),(0,r.jsx)(n.em,{children:"\u63a8\u5968"}),(0,r.jsx)(n.a,{href:"https://www.pgadmin.org/",children:"pgAdmin"}),"\u307e\u305f\u306f",(0,r.jsx)(n.a,{href:"https://eggerapps.at/postico2/",children:"Postico"}),"\u7b49\u306eGUI\u306e\u4f7f\u7528\u3092\u691c\u8a0e\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,r.jsxs)(n.p,{children:["\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\u65b9\u6cd5\u306e\u8aac\u660e\u306f\u3001\u3053\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u306e\u7bc4\u56f2\u3092\u8d85\u3048\u3066\u3044\u307e\u3059\u3002\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306e\u4f5c\u6210\u65b9\u6cd5\u304c\u5206\u304b\u3089\u306a\u3044\u5834\u5408\u306f\u3001",(0,r.jsx)(n.code,{children:"psql"}),"\u30c4\u30fc\u30eb\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3059\u308b\u65b9\u6cd5\u306e\u30c1\u30e5\u30fc\u30c8\u30ea\u30a2\u30eb\u3092\u5fa1\u78ba\u8a8d\u4e0b\u3055\u3044\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u74b0\u5883\u8a2d\u5b9a",children:"\u74b0\u5883\u8a2d\u5b9a"}),"\n",(0,r.jsx)(n.h3,{id:"postgresql\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u8a2d\u5b9a\u3059\u308b",children:"PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u8a2d\u5b9a\u3059\u308b"}),"\n",(0,r.jsxs)(n.p,{children:["\u5fc5\u305a",(0,r.jsx)(n.code,{children:"postgresql"}),"\u30b5\u30fc\u30d3\u30b9\u3092\u958b\u59cb\u3057\u3066\u4e0b\u3055\u3044\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"Linux/WSL \u306e\u30b3\u30de\u30f3\u30c9\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u306a\u308a\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"sudo service postgresql start\n"})}),"\n",(0,r.jsx)(n.p,{children:"Mac\u3067brew\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u4ee5\u4e0b\u306e\u69d8\u306b\u8d77\u52d5\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"brew services start postgresql\n"})}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"coin_flip"}),"\u3068\u3044\u3046\u540d\u524d\u3067\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3057\u307e\u3059\u3002\u30e6\u30fc\u30b6\u30fc\u540d\u306f",(0,r.jsx)(n.code,{children:"user"}),"\u3001\u30d1\u30b9\u30ef\u30fc\u30c9\u306f",(0,r.jsx)(n.code,{children:"password"}),"\u3067\u3059\u3002",(0,r.jsx)(n.code,{children:"DBeaver"}),"\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001",(0,r.jsx)(n.code,{children:"Databases"}),"\u30bf\u30d6\u3092\u53f3\u30af\u30ea\u30c3\u30af\u3057\u3066",(0,r.jsx)(n.code,{children:"Create New Database"}),"\u3092\u9078\u629e\u3059\u308b\u3053\u3068\u3067\u3001\u65b0\u3057\u3044\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u4f5c\u6210\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u304c\u6b63\u3057\u304f\u8a2d\u5b9a\u3055\u308c\u3066",(0,r.jsx)(n.code,{children:"psql"}),"\u30c4\u30fc\u30eb\u304c\u3042\u308b\u5834\u5408\u306f\u3001",(0,r.jsx)(n.code,{children:"psql coin_flip"}),"\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3067\u304d\u308b\u306f\u305a\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(n.h3,{id:"poetry\u3068grpc\u3067\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3092\u8a2d\u5b9a\u3059\u308b",children:"Poetry\u3068gRPC\u3067\u30ed\u30fc\u30ab\u30eb\u74b0\u5883\u3092\u8a2d\u5b9a\u3059\u308b"}),"\n",(0,r.jsxs)(n.p,{children:["\u307e\u3060",(0,r.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-indexer-processors",children:"\u30ab\u30b9\u30bf\u30e0\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u30ac\u30a4\u30c9"}),"\u5165\u9580\u3092\u8aad\u3093\u3067\u3044\u306a\u3044\u5834\u5408\u306f\u3001\u5fc5\u305a\u8aad\u3093\u3067\u304f\u3060\u3055\u3044\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-indexer-processors/tree/main/python",children:"\u3053\u3053"}),"\u3067\u3001\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u306e\u4f5c\u6210\u65b9\u6cd5\u306b\u95a2\u3059\u308bPython\u56fa\u6709\u306e\u5e83\u7bc4\u306a\u6982\u8981\u3092\u78ba\u8a8d\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u69cb\u6210",children:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u69cb\u6210"}),"\n",(0,r.jsx)(n.p,{children:"\u5b9f\u969b\u306b\u4f7f\u7528\u3059\u308b\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u69cb\u6210\u306e\u8a73\u7d30\u3092\u8a2d\u5b9a\u3057\u307e\u3057\u3087\u3046\u3002"}),"\n",(0,r.jsx)(n.h3,{id:"configyaml\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a",children:"config.yaml\u30d5\u30a1\u30a4\u30eb\u306e\u8a2d\u5b9a"}),"\n",(0,r.jsxs)(n.p,{children:["\u4ee5\u4e0b\u306e\u5185\u5bb9\u3092\u30b3\u30d4\u30fc\u3057\u3001",(0,r.jsx)(n.code,{children:"config.yaml"}),"\u3068\u3044\u3046\u540d\u524d\u306e\u30d5\u30a1\u30a4\u30eb\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002\u305d\u306e\u30d5\u30a1\u30a4\u30eb\u3092",(0,r.jsx)(n.code,{children:"coin_flip"}),"\u30d5\u30a9\u30eb\u30c0\u30fc\u306b\u4fdd\u5b58\u3057\u307e\u3059\u3002\u30d5\u30a1\u30a4\u30eb\u306e\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u69cb\u9020\u306f\u4ee5\u4e0b\u306e\u69d8\u306b\u306a\u308a\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"- aptos-indexer-processor\n    - python\n        - processors\n            - aptos_ambassador_token\n            - aptos-tontine\n            - coin_flip\n                - move\n                    - sources\n                        - coin_flip.move\n                        - package_manager.move\n                    - Move.toml\n                - config.yaml     <-------- Create and edit this config.yaml file\n                - models.py\n                - processor.py\n                - README.md\n            - example_event_processor\n            - nft_marketplace_v2\n            - nft_orderbooks\n            __init__.py\n            main.py\n            README.md\n    - rust\n    - scripts\n    - typescript\n"})}),"\n",(0,r.jsxs)(n.p,{children:["config.yaml\u30d5\u30a1\u30a4\u30eb\u3092\u958b\u3044\u305f\u3089\u3001\u4ee5\u4e0b\u306e\u7279\u5b9a\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u66f4\u65b0\u3059\u308b\u3060\u3051\u3067\u3059\u3002\n",(0,r.jsx)(n.code,{children:"processor_config.type"})," - \u30d7\u30ed\u30bb\u30c3\u30b5",(0,r.jsx)(n.code,{children:"chain_id"}),"\u306e\u540d\u524d\n",(0,r.jsx)(n.code,{children:"indexer_grpc_data_service_address"})," - \u30a4\u30f3\u30c7\u30af\u30b5\u30fc \u30c7\u30fc\u30bf \u30b5\u30fc\u30d3\u30b9\u306e\u30a2\u30c9\u30ec\u30b9\n",(0,r.jsx)(n.code,{children:"auth_token"})," - \u958b\u767a\u8005\u30dd\u30fc\u30bf\u30eb\u3067\u4f5c\u6210\u3057\u305fAPI\u30ad\u30fc\n",(0,r.jsx)(n.code,{children:"postgres_connection_string"})," - PostgreSQL\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3078\u306e\u63a5\u7d9a\u6587\u5b57\u5217\n",(0,r.jsx)(n.code,{children:"starting_version"})," - starting_version- \u51e6\u7406\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u958b\u59cb\u30d0\u30fc\u30b8\u30e7\u30f3\n",(0,r.jsx)(n.code,{children:"ending_version"})," - \u51e6\u7406\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u7d42\u4e86\u30d0\u30fc\u30b8\u30e7\u30f3"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'server_config:\n  processor_config:\n    type: "coin_flip"\n  chain_id: 2\n  indexer_grpc_data_service_address: "grpc.testnet.aptoslabs.com:443"\n  auth_token: "<API-KEY>"\n  postgres_connection_string: "postgresql://localhost:5432/<Database Name>"\n  # Optional. Start processor at starting_version\n  starting_version: 636585029\n  # Optional. Stop processor after ending_version.\n  ending_version: 636589723\n'})}),"\n",(0,r.jsx)(n.h3,{id:"configyaml\u3092\u66f4\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba",children:"config.yaml\u3092\u66f4\u306b\u30ab\u30b9\u30bf\u30de\u30a4\u30ba"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"config.yaml"}),"\u30d5\u30a1\u30a4\u30eb\u3092\u4f7f\u7528\u3057\u3066\u8ffd\u52a0\u306e\u69cb\u6210\u3092\u30ab\u30b9\u30bf\u30de\u30a4\u30ba\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u7279\u5b9a\u306e\u53f0\u5e33\u30d0\u30fc\u30b8\u30e7\u30f3\u304b\u3089\u958b\u59cb\u3059\u308b\u306b\u306f\u3001\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3067",(0,r.jsx)(n.code,{children:"config.yaml"}),"\u30d5\u30a1\u30a4\u30eb\u5185\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"starting_version: <Starting Version>\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u3053\u308c\u306f\u3001\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u304c\u30a4\u30d9\u30f3\u30c8\u306e\u691c\u7d22\u3092\u958b\u59cb\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u30d0\u30fc\u30b8\u30e7\u30f3\u3067\u3059\u3002"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"next_versions_to_process"}),"\u30c6\u30fc\u30d6\u30eb\u306f\u3001\u30a4\u30f3\u30c7\u30c3\u30af\u30b9\u4f5c\u6210\u306e\u73fe\u5728\u306e\u72b6\u614b\u3092\u8ffd\u8de1\u3057\u307e\u3059\u3002\u4e3b\u30ad\u30fc\u306f",(0,r.jsx)(n.code,{children:"indexer_name"}),"\u3067\u3059\u3002\u3053\u306e",(0,r.jsx)(n.code,{children:"next_version"}),"\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u3001\u6b21\u306b\u51e6\u7406\u3059\u308b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u793a\u3057\u3001",(0,r.jsx)(n.code,{children:"updated_at"}),"\u6642\u523b\u306f\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u304c\u6700\u5f8c\u306b\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u51e6\u7406\u3057\u305f\u6642\u523b\u3092\u793a\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"ending_version: <Ending Version>\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u3059\u3079\u3066\u306e Coin Flip \u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u30ea\u30b9\u30c8\u3092\u8868\u793a\u3057\u305f\u3044\u5834\u5408\u306f\u3001",(0,r.jsx)(n.a,{href:"https://explorer.aptoslabs.com/?network=testnet",children:"Aptos Explorer"}),"\u3067\u691c\u7d22\u3067\u304d\u307e\u3059\u3002",(0,r.jsx)(n.code,{children:"0xe57752173bc7c57e9b61c84895a75e53cd7c0ef0855acd81d31cb39b0e87e1d0"}),"\u30a2\u30ab\u30a6\u30f3\u30c8\u3092\u691c\u7d22\u3057\u307e\u3059\u3002 - \u3053\u308c\u306fCoinFlip\u30e2\u30b8\u30e5\u30fc\u30eb\u304c\u30c7\u30d7\u30ed\u30a4\u3055\u308c\u305f\u30a2\u30ab\u30a6\u30f3\u30c8\u3067\u3059\u3002\u7d50\u679c\u306b\u306f\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u30ea\u30b9\u30c8\u3068\u305d\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002 \u30d0\u30fc\u30b8\u30e7\u30f3\u756a\u53f7\u3092\u4f7f\u7528\u3057\u3066\u3001config.yaml\u30d5\u30a1\u30a4\u30eb\u5185\u3067",(0,r.jsx)(n.code,{children:"starting_version"}),"\u3068",(0,r.jsx)(n.code,{children:"ending_version"}),"\u3092\u6307\u5b9a\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5225\u306e\u30cd\u30c3\u30c8\u30ef\u30fc\u30af\u3092\u4f7f\u7528\u3059\u308b\u5834\u5408\u306f\u3001",(0,r.jsx)(n.code,{children:"indexer_grpc_data_service_address"}),"\u30d5\u30a3\u30fc\u30eb\u30c9\u3092\u5bfe\u5fdc\u3059\u308b\u76ee\u7684\u306e\u5024\u306b\u5909\u66f4\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"# Devnet\nindexer_grpc_data_service_address: grpc.devnet.aptoslabs.com:443\n\n# Testnet\nindexer_grpc_data_service_address: grpc.testnet.aptoslabs.com:443\n\n# Mainnet\nindexer_grpc_data_service_address: grpc.mainnet.aptoslabs.com:443\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u3053\u308c\u3089\u306eIP\u30a2\u30c9\u30ec\u30b9\u304c\u6a5f\u80fd\u3057\u306a\u3044\u5834\u5408\u306f\u3001\u671f\u9650\u5207\u308c\u3067\u3042\u308b\u53ef\u80fd\u6027\u304c\u3042\u308a\u307e\u3059\u3002\u6700\u65b0\u306e\u30a8\u30f3\u30c9\u30dd\u30a4\u30f3\u30c8\u306b\u3064\u3044\u3066\u306f\u3001\u30ea\u30dd\u30b8\u30c8\u30ea\u306e\u30eb\u30fc\u30c8\u30d5\u30a9\u30eb\u30c0\u30fc\u306e",(0,r.jsx)(n.code,{children:"README.md"}),"\u3092\u78ba\u8a8d\u3057\u3066\u304f\u3060\u3055\u3044\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5225\u306e\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u540d\u307e\u305f\u306f\u30d7\u30ed\u30bb\u30c3\u30b5\u540d\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u56fa\u6709\u306e\u8981\u6c42\u306b\u5fdc\u3058\u3066",(0,r.jsx)(n.code,{children:"postgres_connection_string"}),"\u3092\u5909\u66f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002\u30d5\u30a3\u30fc\u30eb\u30c9\u306e\u4e00\u822c\u7684\u306a\u69cb\u9020\u306f\u4ee5\u4e0b\u306e\u901a\u308a\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:'postgres_connection_string: "postgresql://username:password@database_url:port_number/database_name"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u3068\u30b9\u30ad\u30fc\u30de\u540d\u3092\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3078\u8ffd\u52a0\u3059\u308b",children:"\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u3068\u30b9\u30ad\u30fc\u30de\u540d\u3092\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3078\u8ffd\u52a0\u3059\u308b"}),"\n",(0,r.jsxs)(n.p,{children:["\u307e\u305a\u3001\u4f7f\u7528\u3059\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30b9\u30ad\u30fc\u30de\u306e\u540d\u524d\u3092\u4f5c\u6210\u3057\u307e\u3057\u3087\u3046\u3002\u3053\u306e\u4f8b\u3067\u306f",(0,r.jsx)(n.code,{children:"coin_flip"}),"\u3092\u4f7f\u7528\u3057\u3066\u3044\u308b\u305f\u3081\u3001\u4ee5\u4e0b\u306e2\u3064\u306e\u5834\u6240\u306b\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"]}),"\n",(0,r.jsxs)(n.ol,{children:["\n",(0,r.jsxs)(n.li,{children:["\u3053\u308c\u3092",(0,r.jsx)(n.code,{children:"python/utils/processor_name.py"}),"\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u52a0\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'    class ProcessorName(Enum):\n        EXAMPLE_EVENT_PROCESSOR = "python_example_event_processor"\n        NFT_MARKETPLACE_V1_PROCESSOR = "nft_marketplace_v1_processor"\n        NFT_MARKETPLACE_V2_PROCESSOR = "nft_marketplace_v2_processor"\n        COIN_FLIP = "coin_flip"\n'})}),"\n",(0,r.jsxs)(n.ol,{start:"2",children:["\n",(0,r.jsxs)(n.li,{children:["\u3053\u308c\u3092",(0,r.jsx)(n.code,{children:"IndexerProcessorServer"}),"\u306e\u30b3\u30f3\u30b9\u30c8\u30e9\u30af\u30bf\u30fc",(0,r.jsx)(n.code,{children:"utils/worker.py"}),"\u5185\u306ematch cases\u3078\u8ffd\u52a0\u3057\u307e\u3059\u3002"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"match self.config.processor_name:\n    case ProcessorName.EXAMPLE_EVENT_PROCESSOR.value:\n        self.processor = ExampleEventProcessor()\n    case ProcessorName.NFT_MARKETPLACE_V1_PROCESSOR.value:\n        self.processor = NFTMarketplaceProcesser()\n    case ProcessorName.NFT_MARKETPLACE_V2_PROCESSOR.value:\n        self.processor = NFTMarketplaceV2Processor()\n    case ProcessorName.COIN_FLIP.value:\n        self.processor = CoinFlipProcessor()\n"})}),"\n",(0,r.jsxs)(n.ol,{start:"3",children:["\n",(0,r.jsxs)(n.li,{children:["\u3053\u308c\u3092",(0,r.jsx)(n.code,{children:"python/utils/models/schema_names.py"}),"\u30d5\u30a1\u30a4\u30eb\u306b\u8ffd\u52a0\u3057\u307e\u3059"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'EXAMPLE = "example"\nNFT_MARKETPLACE_SCHEMA_NAME = "nft_marketplace"\nNFT_MARKETPLACE_V2_SCHEMA_NAME = "nft_marketplace_v2"\nCOIN_FLIP_SCHEMA_NAME = "coin_flip"\n'})}),"\n",(0,r.jsx)(n.h3,{id:"move\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3067\u306e\u30a4\u30d9\u30f3\u30c8\u767a\u884c\u306e\u89e3\u8aac",children:"Move\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u3067\u306e\u30a4\u30d9\u30f3\u30c8\u767a\u884c\u306e\u89e3\u8aac"}),"\n",(0,r.jsxs)(n.p,{children:["Move\u30b3\u30f3\u30c8\u30e9\u30af\u30c8(",(0,r.jsx)(n.code,{children:"coin_flip/move/sources/coin_flip.move"}),"\u5185)\u3067\u306f\u3001\u5404\u30e6\u30fc\u30b6\u30fc\u306f\u81ea\u5206\u306e\u30a2\u30ab\u30a6\u30f3\u30c8\u306b\u95a2\u9023\u4ed8\u3051\u3089\u308c\u305f\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u3092\u6301\u3063\u3066\u3044\u307e\u3059\u3002\u3053\u306e\u30aa\u30d6\u30b8\u30a7\u30af\u30c8\u306b\u306f\u3001",(0,r.jsx)(n.code,{children:"CoinFlipStats"}),"\u30ea\u30bd\u30fc\u30b9\u304c\u542b\u307e\u308c\u3066\u3044\u3066\u3001\u30e6\u30fc\u30b6\u30fc\u306e\u52dd\u6557\u306e\u5408\u8a08\u6570\u3092\u8ffd\u8de1\u3057\u3001\u30a4\u30d9\u30f3\u30c8\u306e\u767a\u884c\u3092\u62c5\u5f53\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"// CoinFlipStats object/resource definition\n#[resource_group_member(group = aptos_framework::object::ObjectGroup)]\nstruct CoinFlipStats has key {\n    wins: u64,\n    losses: u64,\n    event_handle: EventHandle<CoinFlipEvent>,  //\n    delete_ref: DeleteRef,\n}\n\n// event emission in `flip_coin`\nfun flip_coin(\n    user: &signer,\n    prediction: bool,\n    nonce: u64,\n) acquires CoinFlipStats {\n    // ...\n    let (heads, correct_prediction) = flip(prediction, nonce);\n\n    if (correct_prediction) {\n        coin_flip_stats.wins = coin_flip_stats.wins + 1;\n    } else {\n        coin_flip_stats.losses = coin_flip_stats.losses + 1;\n    };\n\n    event::emit_event<CoinFlipEvent>(\n        &mut coin_flip_stats.event_handle,\n        CoinFlipEvent {\n            prediction: prediction,\n            result: heads,\n            wins: coin_flip_stats.wins,\n            losses: coin_flip_stats.losses,\n        }\n    );\n}\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u767a\u884c\u3055\u308c\u308b\u30a4\u30d9\u30f3\u30c8\u306e\u30bf\u30a4\u30d7\u306f",(0,r.jsx)(n.code,{children:"CoinFlipEvent"}),"\u3067\u3001\u4ee5\u4e0b\u306b\u793a\u3059\u3068\u304a\u308a\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-rust",children:"struct CoinFlipEvent has copy, drop, store {\n    prediction: bool,     // true = heads, false = tails\n    result: bool,\n    wins: u64,\n    losses: u64,\n}\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u304c\u3069\u306e\u69d8\u306b\u51fa\u529b\u51e6\u7406\u3055\u308c\u308b\u306e\u304b\u898b\u3066\u7406\u89e3\u3059\u308b",children:"\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u304c\u3069\u306e\u69d8\u306b\u51fa\u529b\u3001\u51e6\u7406\u3055\u308c\u308b\u306e\u304b\u898b\u3066\u7406\u89e3\u3059\u308b"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"coin_flip"}),"\u30a8\u30f3\u30c8\u30ea\u95a2\u6570\u3092\u547c\u3073\u51fa\u3059\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3092\u9001\u4fe1\u3059\u308b\u3068\u3001\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u306f\u30a4\u30d9\u30f3\u30c8\u3092\u89e3\u6790\u3057\u3001\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u5185\u3067\u767a\u751f\u3057\u305f\u5404\u30a4\u30d9\u30f3\u30c8\u306e\u30c7\u30fc\u30bf\u3092\u8a18\u9332\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsxs)(n.p,{children:["\u5404",(0,r.jsx)(n.code,{children:"Event"}),"\u30bf\u30a4\u30d7\u306e",(0,r.jsx)(n.code,{children:"data"}),"\u30d5\u30a3\u30fc\u30eb\u30c9\u5185\u306b\u3001\u51fa\u529b\u3055\u308c\u305f\u4efb\u610f\u306e\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u304c\u8868\u793a\u3055\u308c\u307e\u3059\u3002\u3053\u306e\u30c7\u30fc\u30bf\u306f\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u3092\u4fdd\u5b58\u3059\u308b\u305f\u3081\u306b\u4f7f\u7528\u3055\u308c\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.p,{children:"\u30d7\u30ed\u30bb\u30c3\u30b5\u306f\u3001\u5404\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u306e\u5404\u30a4\u30d9\u30f3\u30c8\u3092\u30eb\u30fc\u30d7\u3057\u3066\u3001\u3059\u3079\u3066\u306e\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u3092\u51e6\u7406\u3057\u307e\u3059\u3002\u30c8\u30e9\u30f3\u30b6\u30af\u30b7\u30e7\u30f3\u3067\u306f\u3055\u307e\u3056\u307e\u306a\u30bf\u30a4\u30d7\u306e\u30a4\u30d9\u30f3\u30c8\u304c\u591a\u6570\u767a\u751f\u3059\u308b\u53ef\u80fd\u6027\u304c\u3042\u308b\u305f\u3081\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u4fdd\u5b58\u3057\u305f\u304f\u306a\u3044\u3055\u307e\u3056\u307e\u306a\u30a4\u30d9\u30f3\u30c8\u306b\u5bfe\u51e6\u3059\u308b\u30d5\u30a3\u30eb\u30bf\u30ea\u30f3\u30b0\u95a2\u6570\u3092\u4f5c\u6210\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.p,{children:"\u3053\u308c\u306f\u3001\u30a4\u30d9\u30f3\u30c8\u30ea\u30b9\u30c8\u306e\u5358\u7d14\u306a\u53cd\u5fa9\u69cb\u9020\u3067\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"for event_index, event in enumerate(user_transaction.events):\n    # Skip events that don't match our filter criteria\n    if not CoinFlipProcessor.included_event_type(event.type_str):\n        continue\n"})}),"\n",(0,r.jsxs)(n.p,{children:["\u3053\u3053\u3067\u3001",(0,r.jsx)(n.code,{children:"included_event_type"}),"\u95a2\u6570\u306f",(0,r.jsx)(n.code,{children:"CoinFlipProcessor"}),"\u30af\u30e9\u30b9\u306e\u9759\u7684\u30e1\u30bd\u30c3\u30c9\u3067\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'@staticmethod\ndef included_event_type(event_type: str) -> bool:\n    parsed_tag = event_type.split("::")\n    module_address = parsed_tag[0]\n    module_name = parsed_tag[1]\n    event_type = parsed_tag[2]\n    # Now we can filter out events that are not of type CoinFlipEvent\n    # We can filter by the module address, module name, and event type\n    # If someone deploys a different version of our contract with the same event type, we may want to index it one day.\n    # So we could only check the event type instead of the full string\n    # For our sake, check the full string\n    return (\n        module_address\n        == "0xe57752173bc7c57e9b61c84895a75e53cd7c0ef0855acd81d31cb39b0e87e1d0"\n        and module_name == "coin_flip"\n        and event_type == "CoinFlipEvent"\n    )\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u30d7\u30ed\u30bb\u30c3\u30b5\u30eb\u30fc\u30d7\u5185\u3067\u81ea\u5206\u3067\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3057\u305f\u3044\u5834\u5408\u306f\u3001",(0,r.jsx)(n.code,{children:"processor.py"}),"\u30d5\u30a1\u30a4\u30eb\u306b\u4ee5\u4e0b\u306e\u69d8\u306a\u7269\u3092\u8ffd\u52a0\u3067\u304d\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"for event_index, event in enumerate(user_transaction.events):\n    # Skip events that don't match our filter criteria\n    if not CoinFlipProcessor.included_event_type(event.type_str):\n        continue\n\n    # ...\n\n    # Load the data into a JSON object and then use/view it as a regular dictionary\n    data = json.loads(event.data)\n    print(json.dumps(data, indent=3))\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u3053\u306e\u5834\u5408\u3001\u5358\u4e00\u306e\u30a4\u30d9\u30f3\u30c8\u304c\u3053\u308c\u3092\u51fa\u529b\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"{\n    'losses': '49',\n    'prediction': False,\n    'result': True,\n    'wins': '51'\n}\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4ee5\u4e0b\u306e\u69d8\u306b\u30c7\u30fc\u30bf\u3092\u53d6\u5f97\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'prediction = bool(data["prediction"])\nresult = bool(data["result"])\nwins = int(data["wins"])\nlosses = int(data["losses"])\n\n# We have extra data to insert into the database, because we want to process our data.\n# Calculate the total\nwin_percentage = wins / (wins + losses)\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u3053\u308c\u3092\u30a4\u30d9\u30f3\u30c8\u30ea\u30b9\u30c8\u306b\u8ffd\u52a0\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:"# Create an instance of CoinFlipEvent\nevent_db_obj = CoinFlipEvent(\n    sequence_number=sequence_number,\n    creation_number=creation_number,\n    account_address=account_address,\n    transaction_version=transaction_version,\n    transaction_timestamp=transaction_timestamp,\n    prediction=prediction,\n    result=result,\n    wins=wins,\n    losses=losses,\n    win_percentage=win_percentage,\n    inserted_at=datetime.now(),\n    event_index=event_index,  # when multiple events of the same type are emitted in a single transaction, this is the index of the event in the transaction\n)\nevent_db_objs.append(event_db_obj)\n"})}),"\n",(0,r.jsx)(n.h3,{id:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e2\u30c7\u30eb\u306e\u4f5c\u6210",children:"\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u30e2\u30c7\u30eb\u306e\u4f5c\u6210"}),"\n",(0,r.jsxs)(n.p,{children:[(0,r.jsx)(n.code,{children:"models.py"}),"\u306e",(0,r.jsx)(n.code,{children:"CoinFlipEvent"}),"\u30af\u30e9\u30b9\u3092\u69cb\u9020\u5316\u3057\u3001Move\u30b3\u30f3\u30c8\u30e9\u30af\u30c8\u306e\u69cb\u9020\u3092\u53cd\u6620\u3059\u308b\u5fc5\u8981\u304c\u3042\u308a\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-python",children:'class CoinFlipEvent(Base):\n    __tablename__ = "coin_flip_events"\n    __table_args__ = ({"schema": COIN_FLIP_SCHEMA_NAME},)\n\n    sequence_number: BigIntegerPrimaryKeyType\n    creation_number: BigIntegerPrimaryKeyType\n    account_address: StringPrimaryKeyType\n    prediction: BooleanType     # from (event.data["prediction"]\n    result: BooleanType         # from (event.data["result"]\n    wins: BigIntegerType        # from (event.data["wins"]\n    losses: BigIntegerType      # from (event.data["losses"]\n    win_percentage: NumericType # calculated from the above\n    transaction_version: BigIntegerType\n    transaction_timestamp: TimestampType\n    inserted_at: InsertedAtType\n    event_index: BigIntegerType\n'})}),"\n",(0,r.jsx)(n.p,{children:"\u30de\u30fc\u30af\u306e\u306a\u3044\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u3001\u30c7\u30d5\u30a9\u30eb\u30c8\u306e\u30a4\u30d9\u30f3\u30c8\u30c7\u30fc\u30bf(Aptos\u3067\u767a\u884c\u3055\u308c\u305f\u3059\u3079\u3066\u306e\u30a4\u30d9\u30f3\u30c8\u306e\u30c7\u30fc\u30bf)\u304b\u3089\u306e\u3082\u306e\u3067\u3059\u3002\u30de\u30fc\u30af\u3055\u308c\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u306f\u3001\u5177\u4f53\u7684\u306b\u306f\u4e0a\u8a18\u3067\u8a08\u7b97\u3057\u305f\u30d5\u30a3\u30fc\u30eb\u30c9\u304b\u3089\u306e\u3082\u306e\u3067\u3059\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u4ed6\u306e\u30d5\u30a3\u30fc\u30eb\u30c9\u306e",(0,r.jsx)(n.strong,{children:"tablename"}),"\u3068",(0,r.jsx)(n.strong,{children:"table_args"}),"\u306f\n\u4f7f\u7528\u3057\u3066\u3044\u308b\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3068\u30b9\u30ad\u30fc\u30de\u540d\u3092Python SQLAlchemy\u30e9\u30a4\u30d6\u30e9\u30ea\u306b\u793a\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.h2,{id:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u5b9f\u884c",children:"\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30d7\u30ed\u30bb\u30c3\u30b5\u30fc\u306e\u5b9f\u884c"}),"\n",(0,r.jsx)(n.p,{children:"\u69cb\u6210\u30d5\u30a1\u30a4\u30eb\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3001Python \u30c7\u30fc\u30bf\u30d9\u30fc\u30b9 \u30e2\u30c7\u30eb\u304c\u8a2d\u5b9a\u3055\u308c\u305f\u306e\u3067\u3001\u30d7\u30ed\u30bb\u30c3\u30b5\u3092\u5b9f\u884c\u3067\u304d\u307e\u3059\u3002"}),"\n",(0,r.jsxs)(n.p,{children:["\u30a4\u30f3\u30c7\u30af\u30b5\u30fc\u30ea\u30dd\u30b8\u30c8\u30ea\u306e",(0,r.jsx)(n.code,{children:"python"}),"\u30c7\u30a3\u30ec\u30af\u30c8\u30ea\u306b\u79fb\u52d5\u3057\u307e\u3059\u3002"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"cd ~/aptos-indexer-processors/python\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"poetry run python -m processors.main -c processors/coin_flip/config.yaml\n"})}),"\n",(0,r.jsx)(n.p,{children:"pyenv\u306e\u30d0\u30fc\u30b8\u30e7\u30f3\u306b\u95a2\u3059\u308b\u30a8\u30e9\u30fc\u304c\u767a\u751f\u3057\u305f\u5834\u5408\u306f\u3001\u6b63\u3057\u3044\u30d0\u30fc\u30b8\u30e7\u30f3\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:" pyenv install 3.11.0\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u4f9d\u5b58\u95a2\u4fc2\u30a8\u30e9\u30fc\u304c\u591a\u6570\u767a\u751f\u3059\u308b\u5834\u5408\u306f\u3001Poetry \u3092\u4f7f\u7528\u3057\u3066\u4f9d\u5b58\u95a2\u4fc2\u3092\u30a4\u30f3\u30b9\u30c8\u30fc\u30eb\u3059\u308b\u5fc5\u8981\u304c\u3042\u308b\u5834\u5408\u304c\u3042\u308a\u307e\u3059\u3002/aptos-indexer-processors\u304b\u3089\u4ee5\u4e0b\u306e\u30b3\u30de\u30f3\u30c9\u3092\u5b9f\u884c\u3057\u307e\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:"poetry install\n"})}),"\n",(0,r.jsx)(n.p,{children:"\u30a4\u30d9\u30f3\u30c8\u3092\u6b63\u3057\u304f\u51e6\u7406\u3057\u3066\u3044\u308b\u5834\u5408\u306f\u3001\u30bf\u30fc\u30df\u30ca\u30eb\u51fa\u529b\u306b\u4ee5\u4e0b\u306e\u3088\u3046\u306a\u5185\u5bb9\u304c\u8868\u793a\u3055\u308c\u308b\u306f\u305a\u3067\u3059\u3002"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'{"timestamp": "2023-12-07 18:08:26,493", "level": "INFO", "fields": {"message": "[Parser] Kicking off", "processor_name": "coin_flip", "service_type": "processor"}, "module": "worker", "func_name": "__init__", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 463}\n{"timestamp": "2023-12-07 18:08:26,494", "level": "INFO", "fields": {"message": "[Parser] Initializing DB tables", "processor_name": "coin_flip", "service_type": "processor"}, "module": "worker", "func_name": "run", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 592}\n{"timestamp": "2023-12-07 18:08:26,694", "level": "INFO", "fields": {"message": "[Parser] DB tables initialized", "processor_name": "coin_flip", "service_type": "processor"}, "module": "worker", "func_name": "run", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 600}\n{"timestamp": "2023-12-07 18:08:26,712", "level": "INFO", "fields": {"message": "[Config] Starting from config starting_version"}, "module": "config", "func_name": "get_starting_version", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/config.py", "line_no": 77}\n{"timestamp": "2023-12-07 18:08:26,712", "level": "INFO", "fields": {"message": "[Parser] Starting fetcher task", "processor_name": "coin_flip", "stream_address": "grpc.testnet.aptoslabs.com:443", "start_version": 636585029, "service_type": "processor"}, "module": "worker", "func_name": "run", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 616}\n{"timestamp": "2023-12-07 18:08:26,712", "level": "INFO", "fields": {"message": "[Parser] Setting up rpc channel", "processor_name": "coin_flip", "stream_address": "grpc.testnet.aptoslabs.com:443", "service_type": "processor"}, "module": "worker", "func_name": "get_grpc_stream", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 56}\n{"timestamp": "2023-12-07 18:08:26,730", "level": "INFO", "fields": {"message": "[Parser] Setting up stream", "processor_name": "coin_flip", "stream_address": "grpc.testnet.aptoslabs.com:443", "starting_version": 636585029, "ending_version": 636589723, "count": 4695, "service_type": "processor"}, "module": "worker", "func_name": "get_grpc_stream", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 90}\n{"timestamp": "2023-12-07 18:08:26,733", "level": "INFO", "fields": {"message": "[Parser] Successfully connected to GRPC endpoint", "processor_name": "coin_flip", "stream_address": "grpc.testnet.aptoslabs.com:443", "starting_version": 636585029, "ending_version": 636589723, "service_type": "processor"}, "module": "worker", "func_name": "producer", "path_name": "/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py", "line_no": 147}\n'})}),"\n",(0,r.jsxs)(n.p,{children:["\u3053\u306e\u69d8\u306a\u51fa\u529b\u304c\u51fa\u305f\u3089\u5927\u4e08\u592b\u3067\u3059\uff01\u3053\u308c\u3067\u3001\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u3092\u8868\u793a\u3057\u3066\u3001\u4fdd\u5b58\u3055\u308c\u3066\u3044\u308b\u30c7\u30fc\u30bf\u3092\u78ba\u8a8d\u3067\u304d\u308b\u3088\u3046\u306b\u306a\u308a\u307e\u3059\u3002\u30c7\u30fc\u30bf\u30d9\u30fc\u30b9\u306b\u306f\u3001",(0,r.jsx)(n.code,{children:"coin_flip_events"}),"\u3068",(0,r.jsx)(n.code,{children:"next_versions_to_process"}),"\u306e2\u3064\u306e\u30c6\u30fc\u30d6\u30eb\u304c\u4f5c\u6210\u3055\u308c\u3066\u3044\u308b\u306f\u305a\u3067\u3059\u3002\u89e3\u6790\u3055\u308c\u305f\u30c7\u30fc\u30bf\u306f",(0,r.jsx)(n.code,{children:"coin_flip_events"}),"\u306b\u4fdd\u5b58\u3055\u308c\u307e\u3059\u3002"]})]})}function p(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},83581:(e,n,s)=>{s.d(n,{R:()=>i,x:()=>c});var r=s(11855);const o={},t=r.createContext(o);function i(e){const n=r.useContext(t);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:i(e.components),r.createElement(t.Provider,{value:n},e.children)}}}]);