"use strict";(self.webpackChunkaptos_docs=self.webpackChunkaptos_docs||[]).push([[6965],{73242:(e,n,o)=>{o.r(n),o.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>r,toc:()=>c});var t=o(63159),s=o(83581);const i={title:"Using Docker",slug:"deploy-a-pfn-docker"},a="Deploy a PFN using Docker",r={id:"nodes/full-node/deployments/using-docker",title:"Using Docker",description:"This section describes how to configure and run your PFN using Docker.",source:"@site/i18n/ja/docusaurus-plugin-content-docs/current/nodes/full-node/deployments/using-docker.md",sourceDirName:"nodes/full-node/deployments",slug:"/nodes/full-node/deployments/deploy-a-pfn-docker",permalink:"/nodes/full-node/deployments/deploy-a-pfn-docker",draft:!1,unlisted:!1,editUrl:"https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/nodes/full-node/deployments/using-docker.md",tags:[],version:"current",lastUpdatedAt:1713276994,formattedLastUpdatedAt:"2024\u5e744\u670816\u65e5",frontMatter:{title:"Using Docker",slug:"deploy-a-pfn-docker"},sidebar:"nodeSidebar",previous:{title:"Using Source Code",permalink:"/nodes/full-node/deployments/deploy-a-pfn-source-code"},next:{title:"Using GCP",permalink:"/nodes/full-node/deployments/deploy-a-pfn-gcp"}},d={},c=[];function l(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",li:"li",ol:"ol",p:"p",pre:"pre",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"deploy-a-pfn-using-docker",children:"Deploy a PFN using Docker"}),"\n",(0,t.jsx)(n.p,{children:"This section describes how to configure and run your PFN using Docker."}),"\n",(0,t.jsx)(n.admonition,{title:"Supported only on x86-64 CPUs",type:"danger",children:(0,t.jsxs)(n.p,{children:["Running aptos-core via Docker is currently only supported on x86-64 CPUs. If you have an Apple M1/M2 (ARM64) Mac, use\nthe aptos-core source code approach (above). If M1/M2 support is important to you, comment on this\nissue: ",(0,t.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-core/issues/1412",children:"https://github.com/aptos-labs/aptos-core/issues/1412"})]})}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["First, install ",(0,t.jsx)(n.a,{href:"https://docs.docker.com/get-docker/",children:"Docker"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Next, run the following script to prepare your local configuration and data directory for mainnet. This will\ndownload the ",(0,t.jsx)(n.code,{children:"fullnode.yaml"})," configuration file, the ",(0,t.jsx)(n.code,{children:"genesis.blob"})," and ",(0,t.jsx)(n.code,{children:"waypoint.txt"})," files for your PFN, and\ncreate a ",(0,t.jsx)(n.code,{children:"data"})," directory to store the blockchain database:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"mkdir mainnet && cd mainnet\nmkdir data && \\\ncurl -O https://raw.githubusercontent.com/aptos-labs/aptos-core/mainnet/docker/compose/aptos-node/fullnode.yaml && \\\ncurl -O https://raw.githubusercontent.com/aptos-labs/aptos-networks/main/mainnet/waypoint.txt && \\\ncurl -O https://raw.githubusercontent.com/aptos-labs/aptos-networks/main/mainnet/genesis.blob\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Don't want to connect to mainnet?",type:"caution",children:(0,t.jsxs)(n.p,{children:["To connect to other networks (e.g., ",(0,t.jsx)(n.code,{children:"devnet"})," and ",(0,t.jsx)(n.code,{children:"testnet"}),"), you can find the genesis and waypoint here \u279c ",(0,t.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-networks",children:"https://github.com/aptos-labs/aptos-networks"}),".\nBe sure to download the ",(0,t.jsx)(n.code,{children:"genesis.blob"})," and ",(0,t.jsx)(n.code,{children:"waypoint.txt"})," for those networks, instead of using the genesis\nand waypoint pointed to by the ",(0,t.jsx)(n.code,{children:"curl"})," commands above."]})}),"\n",(0,t.jsxs)(n.ol,{start:"3",children:["\n",(0,t.jsxs)(n.li,{children:["Next, make sure that the ",(0,t.jsx)(n.code,{children:"fullnode.yaml"})," configuration file that you downloaded above contains only the following content.\nThis will ensure that this configuration is for a PFN and not for another node type (e.g., validator or VFN):"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'base:\n  role: "full_node"\n  data_dir: "/opt/aptos/data"\n  waypoint:\n    from_file: "/opt/aptos/etc/waypoint.txt"\n\nexecution:\n  genesis_file_location: "/opt/aptos/etc/genesis.blob"\n\nfull_node_networks:\n  - network_id: "public"\n    discovery_method: "onchain"\n    listen_address: "/ip4/0.0.0.0/tcp/6182"\n\napi:\n  enabled: true\n  address: "0.0.0.0:8080"\n'})}),"\n",(0,t.jsx)(n.admonition,{title:"Don't want to allow inbound connections?",type:"caution",children:(0,t.jsxs)(n.p,{children:["Override the following if you do not want other PFNs connecting to yours: ",(0,t.jsx)(n.code,{children:'listen_address: "/ip4/127.0.0.1/tcp/6182"'}),"."]})}),"\n",(0,t.jsxs)(n.ol,{start:"4",children:["\n",(0,t.jsxs)(n.li,{children:["Next, run the following ",(0,t.jsx)(n.code,{children:"docker"})," command:"]}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-bash",children:"docker run --pull=always \\\n    --rm -p 8080:8080 \\\n    -p 9101:9101 -p 6180:6180 \\\n    -v $(pwd):/opt/aptos/etc -v $(pwd)/data:/opt/aptos/data \\\n    --workdir /opt/aptos/etc \\\n    --name=aptos-fullnode aptoslabs/validator:mainnet aptos-node \\\n    -f /opt/aptos/etc/fullnode.yaml\n"})}),"\n",(0,t.jsx)(n.admonition,{title:"Sudo access",type:"caution",children:(0,t.jsxs)(n.p,{children:["Note: you may need to prefix the docker command with ",(0,t.jsx)(n.code,{children:"sudo"})," depending on your configuration."]})}),"\n",(0,t.jsx)(n.admonition,{title:"Docker tags",type:"info",children:(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.code,{children:"mainnet"})," tag always refers to the latest official Docker image tag. You can find the latest hash for comparison at:\n",(0,t.jsx)(n.a,{href:"https://github.com/aptos-labs/aptos-networks/tree/main/mainnet",children:"https://github.com/aptos-labs/aptos-networks/tree/main/mainnet"})]})}),"\n",(0,t.jsx)(n.p,{children:"You have now successfully configured and started running a PFN in the Aptos mainnet."}),"\n",(0,t.jsx)(n.admonition,{title:"Verify your PFN",type:"tip",children:(0,t.jsxs)(n.p,{children:["If you want to verify that your PFN is running correctly, you can follow the instructions in the ",(0,t.jsx)(n.a,{href:"/nodes/full-node/verify-pfn",children:"Verify a PFN"})," guide."]})})]})}function p(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(l,{...e})}):l(e)}},83581:(e,n,o)=>{o.d(n,{R:()=>a,x:()=>r});var t=o(11855);const s={},i=t.createContext(s);function a(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:a(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);