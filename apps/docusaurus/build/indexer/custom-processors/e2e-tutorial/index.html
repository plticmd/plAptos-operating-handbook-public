<!doctype html>
<html lang="ja" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-indexer/custom-processors/e2e-tutorial" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.1.1">
<title data-rh="true">End-to-Endチュートリアル | Aptos Docs</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://aptos.dev/img/meta/og-aptos-docs-default.png"><meta data-rh="true" name="twitter:image" content="https://aptos.dev/img/meta/og-aptos-docs-default.png"><meta data-rh="true" property="og:url" content="https://aptos.dev/indexer/custom-processors/e2e-tutorial"><meta data-rh="true" property="og:locale" content="ja"><meta data-rh="true" property="og:locale:alternate" content="en"><meta data-rh="true" name="docusaurus_locale" content="ja"><meta data-rh="true" name="docsearch:language" content="ja"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="End-to-Endチュートリアル | Aptos Docs"><meta data-rh="true" name="description" content="このチュートリアルでは、基本的なカスタムインデクサープロセッサーを作成しAptosブロックチェーン上のイベントとデータを追跡する手順を解説します。"><meta data-rh="true" property="og:description" content="このチュートリアルでは、基本的なカスタムインデクサープロセッサーを作成しAptosブロックチェーン上のイベントとデータを追跡する手順を解説します。"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://aptos.dev/indexer/custom-processors/e2e-tutorial"><link data-rh="true" rel="alternate" href="https://aptos.dev/indexer/custom-processors/e2e-tutorial" hreflang="en"><link data-rh="true" rel="alternate" href="https://aptos.dev/ja/indexer/custom-processors/e2e-tutorial" hreflang="ja"><link data-rh="true" rel="alternate" href="https://aptos.dev/indexer/custom-processors/e2e-tutorial" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://HM7UY0NMLG-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HVB7QFB9PQ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-HVB7QFB9PQ",{})</script>


<link rel="search" type="application/opensearchdescription+xml" title="Aptos Docs" href="/opensearch.xml">




<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.24/dist/katex.min.css" integrity="sha384-odtC+0UGzzFL/6PNoE8rX/SPcQDXBJ+uRepguP4QkPCm2LBxH3FA3y+fKSiJ+AmM" crossorigin="anonymous">
<link rel="stylesheet" href="https://unpkg.com/@stoplight/elements@7.7.5/styles.min.css" integrity="sha384-1lLf7J28IOR7k5RlItk6Y+G3hDgVB3y4RCgWNq6ZSwjYfvJXPtZAdW0uklsAZbGW" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.89bf2db0.css">
<script src="/assets/js/runtime~main.65eb5df6.js" defer="defer"></script>
<script src="/assets/js/main.0a39c1ce.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"dark")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="メインコンテンツまでスキップ"><a class="skipToContent_rfFn" href="#__docusaurus_skipToContent_fallback">メインコンテンツまでスキップ</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/aptos_word.svg" alt="Aptos Labs Logo" class="themedComponent_iS9h themedComponent--light_Wu9q"><img src="/img/aptos_word_dark.svg" alt="Aptos Labs Logo" class="themedComponent_iS9h themedComponent--dark_ZuQW"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link"><svg viewBox="0 0 24 24" width="20" height="20" aria-hidden="true" class="iconLanguage_EebW"><path fill="currentColor" d="M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"></path></svg>日本語</a><ul class="dropdown__menu"><li><a href="/indexer/custom-processors/e2e-tutorial" target="_self" rel="noopener noreferrer" class="dropdown__link" lang="en">English</a></li><li><a href="/ja/indexer/custom-processors/e2e-tutorial" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" lang="ja">日本語</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/aptos-white-paper">Start</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/concepts">Learn about Aptos</a></li><li><a class="dropdown__link" href="/guides/explore-aptos">Explore Aptos</a></li><li><a class="dropdown__link" href="/releases/aptos-releases">Latest Releases</a></li><li><a class="dropdown__link" href="/nodes/networks">Networks</a></li><li><a class="dropdown__link" href="/aptos-white-paper">Read the Aptos White Paper</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/tutorials">Build</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/tutorials">Tutorials</a></li><li><a class="dropdown__link" href="/move/move-on-aptos">Learn the Move Language</a></li><li><a class="dropdown__link" href="/standards">Aptos Standards</a></li><li><a class="dropdown__link" href="/apis">Aptos APIs</a></li><li><a class="dropdown__link" href="/sdks/index">Aptos SDKs</a></li><li><a class="dropdown__link" href="/tools/aptos-cli">Aptos CLI</a></li><li><a class="dropdown__link" href="/integration">Integrate with Aptos</a></li><li><a class="dropdown__link" href="/tutorials/build-e2e-dapp/e2e-dapp-index">Build E2E Dapp on Aptos</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/nodes/nodes-landing">Nodes</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/nodes/nodes-landing">Learn about Nodes</a></li><li><a class="dropdown__link" href="/nodes/validator-node/validators">Run a Validator and VFN</a></li><li><a class="dropdown__link" href="/nodes/full-node/public-fullnode">Run a Public Fullnode</a></li><li><a class="dropdown__link" href="/nodes/operations/operations-index">Bootstrap a Node</a></li><li><a class="dropdown__link" href="/nodes/configure/configure-index">Configure a Node</a></li><li><a class="dropdown__link" href="/nodes/measure/measure-index">Monitor a Node</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/nodes/aptos-api-spec">Reference</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/nodes/aptos-api-spec">Aptos REST API Spec</a></li><li><a class="dropdown__link" href="/reference/error-codes">Aptos Errors Codes</a></li><li><a class="dropdown__link" href="/reference/move">Aptos Move Framework</a></li><li><a class="dropdown__link" href="/reference/glossary">Aptos Glossary</a></li></ul></div><div class="navbar__item dropdown dropdown--hoverable"><a class="navbar__link" aria-haspopup="true" aria-expanded="false" role="button" href="/community">Community</a><ul class="dropdown__menu"><li><a class="dropdown__link" href="/community">Help the Aptos Ecosystem</a></li><li><a class="dropdown__link" href="/community/external-resources">External Resources</a></li><li><a class="dropdown__link" href="/community/site-updates">Update Aptos.dev</a></li><li><a class="dropdown__link" href="/community/aptos-style">Follow Aptos Style</a></li><li><a class="dropdown__link" href="/community/contributors">Contributors</a></li></ul></div></div><div class="navbar__items navbar__items--right"><a href="https://learn.aptoslabs.com/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Learn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_c6F6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><a href="https://github.com/aptos-labs/aptos-developer-discussions/discussions" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Dev Discussions<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_c6F6"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_wwMH colorModeToggle_GDDh"><button class="clean-btn toggleButton_faKJ toggleButtonDisabled_aZcY" type="button" disabled="" title="ダークモードを切り替える(現在はダークモード)" aria-label="ダークモードを切り替える(現在はダークモード)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_m8__"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_ZVRe"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_g2EE"><button type="button" class="DocSearch DocSearch-Button" aria-label="検索"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">検索</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_gkQL"><div class="docsWrapper_Qxyk"><button aria-label="先頭へ戻る" class="clean-btn theme-back-to-top-button backToTopButton_sWPH" type="button"></button><div class="docRoot_uKhe"><aside class="theme-doc-sidebar-container docSidebarContainer_Sj9c"><div class="sidebarViewport_Me7G"><div class="sidebar_JlDQ"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_YW1f"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 sidebar-title">Build</li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/tutorials/">Tutorials</a><button aria-label="Expand sidebar category &#x27;Tutorials&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/move/move-on-aptos">Learn the Move Language</a><button aria-label="Expand sidebar category &#x27;Learn the Move Language&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/standards/">Aptos Standards</a><button aria-label="Expand sidebar category &#x27;Aptos Standards&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" href="/apis/">Aptos APIs</a><button aria-label="Collapse sidebar category &#x27;Aptos APIs&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/apis/fullnode-rest-api">フルノードREST API</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/apis/aptos-labs-developer-portal">Aptosラボ開発者ポータル</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/indexer/indexer-landing">Indexing</a><button aria-label="Expand sidebar category &#x27;Indexing&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" aria-expanded="true" tabindex="0" href="/indexer/custom-processors/">Custom Processors</a><button aria-label="Collapse sidebar category &#x27;Custom Processors&#x27;" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/indexer/custom-processors/e2e-tutorial">End-to-Endチュートリアル</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/indexer/custom-processors/parsing-txns">トランザクションの解析</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/indexer/txn-stream/">Transaction Stream Service</a><button aria-label="Expand sidebar category &#x27;Transaction Stream Service&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" tabindex="0" href="/indexer/legacy/">Legacy Indexer</a><button aria-label="Expand sidebar category &#x27;Legacy Indexer&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/sdks/index">Aptos SDKs</a><button aria-label="Expand sidebar category &#x27;Aptos SDKs&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/tools/aptos-cli/">Aptos CLI</a><button aria-label="Expand sidebar category &#x27;Aptos CLI&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/integration/">Integrate with Aptos</a><button aria-label="Expand sidebar category &#x27;Integrate with Aptos&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/tutorials/build-e2e-dapp/e2e-dapp-index">Build E2E Dapp with Aptos</a><button aria-label="Expand sidebar category &#x27;Build E2E Dapp with Aptos&#x27;" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" aria-expanded="false" href="/category/advanced-builders">Advanced Builder Guides</a><button aria-label="Expand sidebar category &#x27;Advanced Builder Guides&#x27;" type="button" class="clean-btn menu__caret"></button></div></li></ul></nav><button type="button" title="サイドバーを隠す" aria-label="サイドバーを隠す" class="button button--secondary button--outline collapseSidebarButton_snYO"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_Jf0I"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></div></aside><main class="docMainContainer_fHdE"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_OUYU"><div class="docItemContainer_rlCk"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_A7pt" aria-label="パンくずリストのナビゲーション"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="ホームページ" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_cEG4"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/apis/"><span itemprop="name">Aptos APIs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/indexer/custom-processors/"><span itemprop="name">Custom Processors</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">End-to-Endチュートリアル</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_MUT3 theme-doc-toc-mobile tocMobile_q7HR"><button type="button" class="clean-btn tocCollapsibleButton_gS9W">このページの見出し</button></div><div class="theme-doc-markdown markdown"><h1>カスタムインデクサープロセッサの作成</h1>
<p>このチュートリアルでは、基本的なカスタムインデクサープロセッサーを作成しAptosブロックチェーン上のイベントとデータを追跡する手順を解説します。</p>
<p>非常に単純なスマートコントラクトを使用します。<strong>Coin Flip</strong>と呼ばれていて、すでにイベントを発行しています。</p>
<p>スマートコントラクトはすでにデプロイされており、改造に興味がない限り殆どの場合、それを理解する必要はありません。</p>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="始める">始める<a href="#始める" class="hash-link" aria-label="始める への直接リンク" title="始める への直接リンク">​</a></h2>
<p>まず、<a href="https://github.com/aptos-labs/aptos-indexer-processors" target="_blank" rel="noopener noreferrer">aptos-indexer-processors</a>リポジトリのクローンを作成します。</p>
<div class="codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-text codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain"># HTTPS</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">https://github.com/aptos-labs/aptos-indexer-processors.git</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"># SSH</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">git@github.com:aptos-labs/aptos-indexer-processors.git</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>コインフリップディレクトリに移動します。</p>
<div class="codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-text codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd aptos-indexer-processors</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd python/processors/coin_flip</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>プロセッサは、トランザクションストリームサービスからのトランザクションを消費します。Labs-Hostedトランザクションストリームサービスを使用するには、認証トークンが必要です<a href="/indexer/txn-stream/labs-hosted#authorization-via-api-key">このガイド</a>に従い、開発者ポータルからトークンを取得します。このチュートリアルは<code>Testnet</code>用であるため、<code>Testnet</code>のAPIキーを作成します。完了すると、以下のようなトークンが作成されるはずです。</p>
<div class="codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-text codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">aptoslabs_yj4bocpaKy_Q6RBP4cdBmjA8T51hto1GcVX5ZS9S65dx</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>次のツールも必要です。</p>
<ul>
<li><a href="/tools/aptos-cli/install-cli">Aptos CLI</a></li>
<li>Python 3.11+: <a href="https://docs.python-guide.org/starting/installation/#python-3-installation-guides" target="_blank" rel="noopener noreferrer">インストールガイド</a>.</li>
<li>Poetry: <a href="https://python-poetry.org/docs/#installation" target="_blank" rel="noopener noreferrer">インストールガイド</a>.</li>
</ul>
<p>このチュートリアルはデータベースとしてPostgreSQLを使用します。何を使用しても自由ですが、簡単にするためPostgreSQLを使用します。以下のデータベース構成とツールを使用します。</p>
<ul>
<li><a href="https://www.postgresql.org/download/" target="_blank" rel="noopener noreferrer">PostgreSQL</a>
<ul>
<li><code>5432</code>ポートの<code>localhost</code>でホストされているデータベースを使用します。これがデフォルトである必要があります。</li>
<li>ユーザー名を作成したら、そのユーザー名とそれに使用するパスワードを記録して下さい。</li>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-install-postgresql-on-ubuntu-22-04-quickstart" target="_blank" rel="noopener noreferrer">ここ</a>でPostgreSQLとpsqlツールをインストールするチュートリアルを参照し、より迅速にデータベースを設定出来ます。</li>
<li>データベースのデータを簡単に表示するには、<a href="https://dbeaver.io/" target="_blank" rel="noopener noreferrer">DBeaver</a><em>推奨</em><a href="https://www.pgadmin.org/" target="_blank" rel="noopener noreferrer">pgAdmin</a>または<a href="https://eggerapps.at/postico2/" target="_blank" rel="noopener noreferrer">Postico</a>等のGUIの使用を検討してください。</li>
</ul>
</li>
</ul>
<p>データベースの作成方法の説明は、このチュートリアルの範囲を超えています。データベースの作成方法が分からない場合は、<code>psql</code>ツールでデータベースを作成する方法のチュートリアルを御確認下さい。</p>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="環境設定">環境設定<a href="#環境設定" class="hash-link" aria-label="環境設定 への直接リンク" title="環境設定 への直接リンク">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="postgresqlデータベースを設定する">PostgreSQLデータベースを設定する<a href="#postgresqlデータベースを設定する" class="hash-link" aria-label="PostgreSQLデータベースを設定する への直接リンク" title="PostgreSQLデータベースを設定する への直接リンク">​</a></h3>
<p>必ず<code>postgresql</code>サービスを開始して下さい。</p>
<p>Linux/WSL のコマンドは以下の様になります。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">sudo service postgresql start</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>Macでbrewを使用している場合は、以下の様に起動します。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">brew services start postgresql</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p><code>coin_flip</code>という名前でデータベースを作成します。ユーザー名は<code>user</code>、パスワードは<code>password</code>です。<code>DBeaver</code>を使用している場合は、<code>Databases</code>タブを右クリックして<code>Create New Database</code>を選択することで、新しいデータベースを作成できます。</p>
<p>データベースが正しく設定されて<code>psql</code>ツールがある場合は、<code>psql coin_flip</code>コマンドを実行できるはずです。</p>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="poetryとgrpcでローカル環境を設定する">PoetryとgRPCでローカル環境を設定する<a href="#poetryとgrpcでローカル環境を設定する" class="hash-link" aria-label="PoetryとgRPCでローカル環境を設定する への直接リンク" title="PoetryとgRPCでローカル環境を設定する への直接リンク">​</a></h3>
<p>まだ<a href="https://github.com/aptos-labs/aptos-indexer-processors" target="_blank" rel="noopener noreferrer">カスタムプロセッサーガイド</a>入門を読んでいない場合は、必ず読んでください。</p>
<p><a href="https://github.com/aptos-labs/aptos-indexer-processors/tree/main/python" target="_blank" rel="noopener noreferrer">ここ</a>で、インデクサープロセッサの作成方法に関するPython固有の広範な概要を確認できます。</p>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="インデクサープロセッサーの構成">インデクサープロセッサーの構成<a href="#インデクサープロセッサーの構成" class="hash-link" aria-label="インデクサープロセッサーの構成 への直接リンク" title="インデクサープロセッサーの構成 への直接リンク">​</a></h2>
<p>実際に使用するインデクサープロセッサーの構成の詳細を設定しましょう。</p>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="configyamlファイルの設定">config.yamlファイルの設定<a href="#configyamlファイルの設定" class="hash-link" aria-label="config.yamlファイルの設定 への直接リンク" title="config.yamlファイルの設定 への直接リンク">​</a></h3>
<p>以下の内容をコピーし、<code>config.yaml</code>という名前のファイルに保存します。そのファイルを<code>coin_flip</code>フォルダーに保存します。ファイルのディレクトリ構造は以下の様になります。</p>
<div class="codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-text codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">- aptos-indexer-processor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - python</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        - processors</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - aptos_ambassador_token</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - aptos-tontine</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - coin_flip</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                - move</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    - sources</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        - coin_flip.move</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                        - package_manager.move</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                    - Move.toml</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                - config.yaml     &lt;-------- Create and edit this config.yaml file</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                - models.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                - processor.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                - README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - example_event_processor</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - nft_marketplace_v2</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            - nft_orderbooks</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            __init__.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            main.py</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            README.md</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - rust</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - scripts</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    - typescript</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>config.yamlファイルを開いたら、以下の特定のフィールドを更新するだけです。
<code>processor_config.type</code> - プロセッサ<code>chain_id</code>の名前
<code>indexer_grpc_data_service_address</code> - インデクサー データ サービスのアドレス
<code>auth_token</code> - 開発者ポータルで作成したAPIキー
<code>postgres_connection_string</code> - PostgreSQLデータベースへの接続文字列
<code>starting_version</code> - starting_version- 処理するトランザクションの開始バ  ージョン
<code>ending_version</code> - 処理するトランザクションの終了バージョン</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">server_config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">processor_config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token key atrule">type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coin_flip&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">chain_id</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">2</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">indexer_grpc_data_service_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;grpc.testnet.aptoslabs.com:443&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">auth_token</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;API-KEY&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">postgres_connection_string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;postgresql://localhost:5432/&lt;Database Name&gt;&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Optional. Start processor at starting_version</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">starting_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">636585029</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Optional. Stop processor after ending_version.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token key atrule">ending_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">636589723</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="configyamlを更にカスタマイズ">config.yamlを更にカスタマイズ<a href="#configyamlを更にカスタマイズ" class="hash-link" aria-label="config.yamlを更にカスタマイズ への直接リンク" title="config.yamlを更にカスタマイズ への直接リンク">​</a></h3>
<p><code>config.yaml</code>ファイルを使用して追加の構成をカスタマイズできます。</p>
<p>特定の台帳バージョンから開始するには、以下のコマンドで<code>config.yaml</code>ファイル内のバージョンを指定できます。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">starting_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;Starting Version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>これは、インデクサーがイベントの検索を開始するトランザクションバージョンです。</p>
<p><code>next_versions_to_process</code>テーブルは、インデックス作成の現在の状態を追跡します。主キーは<code>indexer_name</code>です。この<code>next_version</code>フィールドは、次に処理するトランザクションを示し、<code>updated_at</code>時刻はインデクサーが最後にトランザクションを処理した時刻を示します。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">ending_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> &lt;Ending Version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">&gt;</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>すべての Coin Flip トランザクションのリストを表示したい場合は、<a href="https://explorer.aptoslabs.com/?network=testnet" target="_blank" rel="noopener noreferrer">Aptos Explorer</a>で検索できます。<code>0xe57752173bc7c57e9b61c84895a75e53cd7c0ef0855acd81d31cb39b0e87e1d0</code>アカウントを検索します。 - これはCoinFlipモジュールがデプロイされたアカウントです。結果には、トランザクションのリストとそのバージョン番号が表示されます。 バージョン番号を使用して、config.yamlファイル内で<code>starting_version</code>と<code>ending_version</code>を指定できます。</p>
<p>別のネットワークを使用する場合は、<code>indexer_grpc_data_service_address</code>フィールドを対応する目的の値に変更します。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Devnet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">indexer_grpc_data_service_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> grpc.devnet.aptoslabs.com</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Testnet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">indexer_grpc_data_service_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> grpc.testnet.aptoslabs.com</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">443</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Mainnet</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token key atrule">indexer_grpc_data_service_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> grpc.mainnet.aptoslabs.com</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token number">443</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>これらのIPアドレスが機能しない場合は、期限切れである可能性があります。最新のエンドポイントについては、リポジトリのルートフォルダーの<code>README.md</code>を確認してください。</p>
<p>別のデータベース名またはプロセッサ名を使用している場合は、固有の要求に応じて<code>postgres_connection_string</code>を変更してください。フィールドの一般的な構造は以下の通りです。</p>
<div class="language-yaml codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-yaml codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token key atrule">postgres_connection_string</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;postgresql://username:password@database_url:port_number/database_name&quot;</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="プロセッサーとスキーマ名を構成ファイルへ追加する">プロセッサーとスキーマ名を構成ファイルへ追加する<a href="#プロセッサーとスキーマ名を構成ファイルへ追加する" class="hash-link" aria-label="プロセッサーとスキーマ名を構成ファイルへ追加する への直接リンク" title="プロセッサーとスキーマ名を構成ファイルへ追加する への直接リンク">​</a></h3>
<p>まず、使用するデータベーススキーマの名前を作成しましょう。この例では<code>coin_flip</code>を使用しているため、以下の2つの場所に追加する必要があります。</p>
<ol>
<li>これを<code>python/utils/processor_name.py</code>ファイルに追加する必要があります。</li>
</ol>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">ProcessorName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Enum</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        EXAMPLE_EVENT_PROCESSOR </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;python_example_event_processor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        NFT_MARKETPLACE_V1_PROCESSOR </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nft_marketplace_v1_processor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        NFT_MARKETPLACE_V2_PROCESSOR </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nft_marketplace_v2_processor&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        COIN_FLIP </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coin_flip&quot;</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="2">
<li>これを<code>IndexerProcessorServer</code>のコンストラクター<code>utils/worker.py</code>内のmatch casesへ追加します。</li>
</ol>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">match</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">config</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">processor_name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">case</span><span class="token plain"> ProcessorName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">EXAMPLE_EVENT_PROCESSOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">processor </span><span class="token operator">=</span><span class="token plain"> ExampleEventProcessor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">case</span><span class="token plain"> ProcessorName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">NFT_MARKETPLACE_V1_PROCESSOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">processor </span><span class="token operator">=</span><span class="token plain"> NFTMarketplaceProcesser</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">case</span><span class="token plain"> ProcessorName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">NFT_MARKETPLACE_V2_PROCESSOR</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">processor </span><span class="token operator">=</span><span class="token plain"> NFTMarketplaceV2Processor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">case</span><span class="token plain"> ProcessorName</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">COIN_FLIP</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">processor </span><span class="token operator">=</span><span class="token plain"> CoinFlipProcessor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<ol start="3">
<li>これを<code>python/utils/models/schema_names.py</code>ファイルに追加します</li>
</ol>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">EXAMPLE </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;example&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NFT_MARKETPLACE_SCHEMA_NAME </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nft_marketplace&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">NFT_MARKETPLACE_V2_SCHEMA_NAME </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;nft_marketplace_v2&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">COIN_FLIP_SCHEMA_NAME </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coin_flip&quot;</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="moveコントラクトでのイベント発行の解説">Moveコントラクトでのイベント発行の解説<a href="#moveコントラクトでのイベント発行の解説" class="hash-link" aria-label="Moveコントラクトでのイベント発行の解説 への直接リンク" title="Moveコントラクトでのイベント発行の解説 への直接リンク">​</a></h3>
<p>Moveコントラクト(<code>coin_flip/move/sources/coin_flip.move</code>内)では、各ユーザーは自分のアカウントに関連付けられたオブジェクトを持っています。このオブジェクトには、<code>CoinFlipStats</code>リソースが含まれていて、ユーザーの勝敗の合計数を追跡し 、イベントの発行を担当します。</p>
<div class="language-rust codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-rust codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)">// CoinFlipStats object/resource definition</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token attribute attr-name" style="color:rgb(241, 250, 140)">#[resource_group_member(group = aptos_framework::object::ObjectGroup)]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token type-definition class-name">CoinFlipStats</span><span class="token plain"> has key </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    wins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">u64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">u64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    event_handle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token class-name">EventHandle</span><span class="token operator">&lt;</span><span class="token class-name">CoinFlipEvent</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)">//</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    delete_ref</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token class-name">DeleteRef</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)">// event emission in `flip_coin`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fun </span><span class="token function" style="color:rgb(80, 250, 123)">flip_coin</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    user</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token operator">&amp;</span><span class="token plain">signer</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    nonce</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">u64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> acquires </span><span class="token class-name">CoinFlipStats</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)">// ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">let</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">heads</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> correct_prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">flip</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> nonce</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">correct_prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">wins </span><span class="token operator">=</span><span class="token plain"> coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">wins </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses </span><span class="token operator">=</span><span class="token plain"> coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token namespace">event</span><span class="token namespace punctuation" style="color:rgb(248, 248, 242)">::</span><span class="token plain">emit_event</span><span class="token operator">&lt;</span><span class="token class-name">CoinFlipEvent</span><span class="token operator">&gt;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token operator">&amp;</span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">mut</span><span class="token plain"> coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">event_handle</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token class-name">CoinFlipEvent</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> heads</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            wins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">wins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">            losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> coin_flip_stats</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>発行されるイベントのタイプは<code>CoinFlipEvent</code>で、以下に示すとおりです。</p>
<div class="language-rust codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-rust codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">struct</span><span class="token plain"> </span><span class="token type-definition class-name">CoinFlipEvent</span><span class="token plain"> has copy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> drop</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> store </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">     </span><span class="token comment" style="color:rgb(98, 114, 164)">// true = heads, false = tails</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    wins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">u64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">u64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="イベントデータがどの様に出力処理されるのか見て理解する">イベントデータがどの様に出力、処理されるのか見て理解する<a href="#イベントデータがどの様に出力処理されるのか見て理解する" class="hash-link" aria-label="イベントデータがどの様に出力、処理されるのか見て理解する への直接リンク" title="イベントデータがどの様に出力、処理されるのか見て理解する への直接リンク">​</a></h3>
<p><code>coin_flip</code>エントリ関数を呼び出すトランザクションを送信すると、インデクサーはイベントを解析し、トランザクション内で発生した各イベントのデータを記録します。</p>
<p>各<code>Event</code>タイプの<code>data</code>フィールド内に、出力された任意のイベントデータが表示されます。このデータは、データベースにイベントデータを保存するために使用されます。</p>
<p>プロセッサは 、各トランザクションの各イベントをループして、すべてのイベントデータを処理します。トランザクションではさまざまなタイプのイベントが多数発生する可能性があるため、データベースに保存したくないさまざまなイベントに対処するフィルタリング関数を作成する必要があります。</p>
<p>これは、イベントリストの単純な反復構造です。</p>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> event_index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> event </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">enumerate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">user_transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Skip events that don&#x27;t match our filter criteria</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> CoinFlipProcessor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">included_event_type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">type_str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">continue</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>ここで、<code>included_event_type</code>関数は<code>CoinFlipProcessor</code>クラスの静的メソッドです。</p>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token decorator annotation punctuation" style="color:rgb(248, 248, 242)">@staticmethod</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">included_event_type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event_type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">-</span><span class="token operator">&gt;</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    parsed_tag </span><span class="token operator">=</span><span class="token plain"> event_type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;::&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    module_address </span><span class="token operator">=</span><span class="token plain"> parsed_tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    module_name </span><span class="token operator">=</span><span class="token plain"> parsed_tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    event_type </span><span class="token operator">=</span><span class="token plain"> parsed_tag</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Now we can filter out events that are not of type CoinFlipEvent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># We can filter by the module address, module name, and event type</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># If someone deploys a different version of our contract with the same event type, we may want to index it one day.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># So we could only check the event type instead of the full string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># For our sake, check the full string</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        module_address</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;0xe57752173bc7c57e9b61c84895a75e53cd7c0ef0855acd81d31cb39b0e87e1d0&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">and</span><span class="token plain"> module_name </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coin_flip&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">and</span><span class="token plain"> event_type </span><span class="token operator">==</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;CoinFlipEvent&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>プロセッサループ内で自分でイベントデータを確認したい場合は、<code>processor.py</code>ファイルに以下の様な物を追加できます。</p>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> event_index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> event </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">enumerate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">user_transaction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">events</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Skip events that don&#x27;t match our filter criteria</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">not</span><span class="token plain"> CoinFlipProcessor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">included_event_type</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">type_str</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">        </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># ...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Load the data into a JSON object and then use/view it as a regular dictionary</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    data </span><span class="token operator">=</span><span class="token plain"> json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">loads</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">json</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">dumps</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> indent</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>この場合、単一のイベントがこれを出力します。</p>
<div class="codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-text codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;losses&#x27;: &#x27;49&#x27;,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;prediction&#x27;: False,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;result&#x27;: True,</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    &#x27;wins&#x27;: &#x27;51&#x27;</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以下の様にデータを取得します。</p>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">prediction </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;prediction&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">result </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">bool</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;result&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">wins </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;wins&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">losses </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">int</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;losses&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># We have extra data to insert into the database, because we want to process our data.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Calculate the total</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">win_percentage </span><span class="token operator">=</span><span class="token plain"> wins </span><span class="token operator">/</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">wins </span><span class="token operator">+</span><span class="token plain"> losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>これをイベントリストに追加します。</p>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Create an instance of CoinFlipEvent</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">event_db_obj </span><span class="token operator">=</span><span class="token plain"> CoinFlipEvent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sequence_number</span><span class="token operator">=</span><span class="token plain">sequence_number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    creation_number</span><span class="token operator">=</span><span class="token plain">creation_number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    account_address</span><span class="token operator">=</span><span class="token plain">account_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transaction_version</span><span class="token operator">=</span><span class="token plain">transaction_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transaction_timestamp</span><span class="token operator">=</span><span class="token plain">transaction_timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    prediction</span><span class="token operator">=</span><span class="token plain">prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result</span><span class="token operator">=</span><span class="token plain">result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    wins</span><span class="token operator">=</span><span class="token plain">wins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    losses</span><span class="token operator">=</span><span class="token plain">losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    win_percentage</span><span class="token operator">=</span><span class="token plain">win_percentage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    inserted_at</span><span class="token operator">=</span><span class="token plain">datetime</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">now</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    event_index</span><span class="token operator">=</span><span class="token plain">event_index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># when multiple events of the same type are emitted in a single transaction, this is the index of the event in the transaction</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">event_db_objs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">append</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">event_db_obj</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_pM13" id="データベースモデルの作成">データベースモデルの作成<a href="#データベースモデルの作成" class="hash-link" aria-label="データベースモデルの作成 への直接リンク" title="データベースモデルの作成 への直接リンク">​</a></h3>
<p><code>models.py</code>の<code>CoinFlipEvent</code>クラスを構造化し、Moveコントラクトの構造を反映する必要があります。</p>
<div class="language-python codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-python codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">CoinFlipEvent</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">Base</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __tablename__ </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;coin_flip_events&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    __table_args__ </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;schema&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> COIN_FLIP_SCHEMA_NAME</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    sequence_number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BigIntegerPrimaryKeyType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    creation_number</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BigIntegerPrimaryKeyType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    account_address</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> StringPrimaryKeyType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    prediction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BooleanType     </span><span class="token comment" style="color:rgb(98, 114, 164)"># from (event.data[&quot;prediction&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    result</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BooleanType         </span><span class="token comment" style="color:rgb(98, 114, 164)"># from (event.data[&quot;result&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    wins</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BigIntegerType        </span><span class="token comment" style="color:rgb(98, 114, 164)"># from (event.data[&quot;wins&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BigIntegerType      </span><span class="token comment" style="color:rgb(98, 114, 164)"># from (event.data[&quot;losses&quot;]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    win_percentage</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> NumericType </span><span class="token comment" style="color:rgb(98, 114, 164)"># calculated from the above</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transaction_version</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BigIntegerType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    transaction_timestamp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> TimestampType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    inserted_at</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> InsertedAtType</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">    event_index</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> BigIntegerType</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>マークのないフィールドは、デフォルトのイベントデータ(Aptosで発行されたすべてのイベントのデータ)からのものです。マークされたフィールドは、具体的には上記で計算したフィールドからのものです。</p>
<p>他のフィールドの<strong>tablename</strong>と<strong>table_args</strong>は
使用しているデータベースとスキーマ名をPython SQLAlchemyライブラリに示します。</p>
<h2 class="anchor anchorWithStickyNavbar_pM13" id="インデクサープロセッサーの実行">インデクサープロセッサーの実行<a href="#インデクサープロセッサーの実行" class="hash-link" aria-label="インデクサープロセッサーの実行 への直接リンク" title="インデクサープロセッサーの実行 への直接リンク">​</a></h2>
<p>構成ファイル、データベース、Python データベース モデルが設定されたので、プロセッサを実行できます。</p>
<p>インデクサーリポジトリの<code>python</code>ディレクトリに移動します。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">cd ~/aptos-indexer-processors/python</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>以下のコマンドを実行します。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">poetry run python -m processors.main -c processors/coin_flip/config.yaml</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>pyenvのバージョンに関するエラーが発生した場合は、正しいバージョンをインストールする必要がある場合があります。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain"> pyenv install 3.11.0</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>依存関係エラーが多数発生する場合は、Poetry を使用して依存関係をインストールする必要がある場合があります。/aptos-indexer-processorsから以下のコマンドを実行します。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">poetry install</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>イベントを正しく処理している場合は、ターミナル出力に以下のような内容が表示されるはずです。</p>
<div class="language-shell codeBlockContainer_YU8y theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_Z3Eu"><pre tabindex="0" class="prism-code language-shell codeBlock_TXgN thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_Szw2"><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,493&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] Kicking off&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;__init__&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 463}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,494&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] Initializing DB tables&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;run&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 592}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,694&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] DB tables initialized&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;run&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 600}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,712&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Config] Starting from config starting_version&quot;}, &quot;module&quot;: &quot;config&quot;, &quot;func_name&quot;: &quot;get_starting_version&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/config.py&quot;, &quot;line_no&quot;: 77}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,712&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] Starting fetcher task&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;stream_address&quot;: &quot;grpc.testnet.aptoslabs.com:443&quot;, &quot;start_version&quot;: 636585029, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;run&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 616}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,712&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] Setting up rpc channel&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;stream_address&quot;: &quot;grpc.testnet.aptoslabs.com:443&quot;, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;get_grpc_stream&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 56}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,730&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] Setting up stream&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;stream_address&quot;: &quot;grpc.testnet.aptoslabs.com:443&quot;, &quot;starting_version&quot;: 636585029, &quot;ending_version&quot;: 636589723, &quot;count&quot;: 4695, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;get_grpc_stream&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 90}</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">{&quot;timestamp&quot;: &quot;2023-12-07 18:08:26,733&quot;, &quot;level&quot;: &quot;INFO&quot;, &quot;fields&quot;: {&quot;message&quot;: &quot;[Parser] Successfully connected to GRPC endpoint&quot;, &quot;processor_name&quot;: &quot;coin_flip&quot;, &quot;stream_address&quot;: &quot;grpc.testnet.aptoslabs.com:443&quot;, &quot;starting_version&quot;: 636585029, &quot;ending_version&quot;: 636589723, &quot;service_type&quot;: &quot;processor&quot;}, &quot;module&quot;: &quot;worker&quot;, &quot;func_name&quot;: &quot;producer&quot;, &quot;path_name&quot;: &quot;/Users/jinhou/Projects/aptos-indexer-processors/python/utils/worker.py&quot;, &quot;line_no&quot;: 147}</span><br></span></code></pre><div class="buttonGroup_YI7t"><button type="button" aria-label="クリップボードにコードをコピー" title="コピー" class="clean-btn"><span class="copyButtonIcons_KVkY" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon__tFq"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_VZKC"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>この様な出力が出たら大丈夫です！これで、データベースを表示して、保存されているデータを確認できるようになります。データベースには、<code>coin_flip_events</code>と<code>next_versions_to_process</code>の2つのテーブルが作成されているはずです。解析されたデータは<code>coin_flip_events</code>に保存されます。</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/aptos-labs/developer-docs/edit/main/apps/docusaurus/docs/indexer/custom-processors/e2e-tutorial.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_l3kn" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>このペ  ージを編集</a></div><div class="col lastUpdated_nZMy"><span class="theme-last-updated"><b><time datetime="2024-04-18T11:28:39.000Z">2024年4月18日</time></b>に<!-- -->最終更新</span></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="ドキュメントページ"><a class="pagination-nav__link pagination-nav__link--prev" href="/indexer/custom-processors/"><div class="pagination-nav__sublabel">前へ</div><div class="pagination-nav__label">カスタムプロセッサー</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/indexer/custom-processors/parsing-txns"><div class="pagination-nav__sublabel">次へ</div><div class="pagination-nav__label">トランザクションの解析</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_HHZg thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#始める" class="table-of-contents__link toc-highlight">始める</a></li><li><a href="#環境設定" class="table-of-contents__link toc-highlight">環境設定</a><ul><li><a href="#postgresqlデータベースを設定する" class="table-of-contents__link toc-highlight">PostgreSQLデータベースを設定する</a></li><li><a href="#poetryとgrpcでローカル環境を設定する" class="table-of-contents__link toc-highlight">PoetryとgRPCでローカル環境を設定する</a></li></ul></li><li><a href="#インデクサープロセッサーの構成" class="table-of-contents__link toc-highlight">インデクサープロセッサーの構成</a><ul><li><a href="#configyamlファイルの設定" class="table-of-contents__link toc-highlight">config.yamlファイルの設定</a></li><li><a href="#configyamlを更にカスタマイズ" class="table-of-contents__link toc-highlight">config.yamlを更にカスタマイズ</a></li><li><a href="#プロセッサーとスキーマ名を構成ファイルへ追加する" class="table-of-contents__link toc-highlight">プロセッサ  ーとスキーマ名を構成ファイルへ追加する</a></li><li><a href="#moveコントラクトでのイベント発行の解説" class="table-of-contents__link toc-highlight">Moveコントラクトでのイベント発行の解説</a></li><li><a href="#イベントデータがどの様に出力処理されるのか見て理解する" class="table-of-contents__link toc-highlight">イベントデータがどの様に出力、処理されるのか見て理解する</a></li><li><a href="#データベースモデルの作成" class="table-of-contents__link toc-highlight">データベースモデルの作成</a></li></ul></li><li><a href="#インデクサープロセッサーの実行" class="table-of-contents__link toc-highlight">インデクサープロセッサーの実行</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                <div class="footer-left">
                  <a class="footer-logo" href="https://aptosfoundation.org" target="_blank" rel="noopener noreferrer" title="Aptos Foundation">
                    <svg width="100%" height="100%" version="1.2" baseProfile="tiny" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 112 112" overflow="visible" xml:space="preserve"><path fill="currentColor" d="M86.6 37.4h-9.9c-1.1 0-2.2-.5-3-1.3l-4-4.5c-1.2-1.3-3.1-1.4-4.5-.3l-.3.3-3.4 3.9c-1.1 1.3-2.8 2-4.5 2H2.9C1.4 41.9.4 46.6 0 51.3h51.2c.9 0 1.8-.4 2.4-1l4.8-5c.6-.6 1.4-1 2.3-1h.2c.9 0 1.8.4 2.4 1.1l4 4.5c.8.9 1.9 1.4 3 1.4H112c-.4-4.7-1.4-9.4-2.9-13.8H86.6zM53.8 65l-4-4.5c-1.2-1.3-3.1-1.4-4.5-.3l-.3.3-3.5 3.9c-1.1 1.3-2.7 2-4.4 2H.8c.9 4.8 2.5 9.5 4.6 14h25.5c.9 0 1.7-.4 2.4-1l4.8-5c.6-.6 1.4-1 2.3-1h.2c.9 0 1.8.4 2.4 1.1l4 4.5c.8.9 1.9 1.4 3 1.4h56.6c2.1-4.4 3.7-9.1 4.6-14H56.8c-1.2 0-2.3-.5-3-1.4zm19.6-43.6 4.8-5c.6-.6 1.4-1 2.3-1h.2c.9 0 1.8.4 2.4 1l4 4.5c.8.9 1.9 1.3 3 1.3h10.8c-18.8-24.8-54.1-29.7-79-11-4.1 3.1-7.8 6.8-11 11H71c1 .2 1.8-.2 2.4-.8zM34.7 94.2c-1.2 0-2.3-.5-3-1.3l-4-4.5c-1.2-1.3-3.2-1.4-4.5-.2l-.2.2-3.5 3.9c-1.1 1.3-2.7 2-4.4 2h-.2C36 116.9 71.7 118 94.4 96.7c.9-.8 1.7-1.7 2.6-2.6H34.7z"/></svg>
                  </a>
                  <div class="copyright">
                    <p class="copyright-text">© 2024 Aptos Foundation</p>
                    <div class="copyright-links">
                      <a href="https://aptosfoundation.org/privacy" target="_blank">Privacy</a>
                      <a href="https://aptosfoundation.org/terms" target="_blank">Terms</a></div>
                  </div>
                </div>
                </li></ul></div><div class="col footer__col"><div class="footer__title"></div><ul class="footer__items clean-list"><li class="footer__item">
                  <p class="right">
                    <nav class="social-links">
                        <a class="social-link" href="https://github.com/aptos-labs/developer-docs" target="_blank" rel="noopener noreferrer" title="Github">
                         <svg width="100%" height="100%" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M10 0C4.47514 0 0 4.47514 0 10C0 14.4199 2.86679 18.1645 6.83855 19.4905C7.33579 19.5826 7.51995 19.2756 7.51995 19.0055C7.51995 18.7661 7.51381 18.14 7.50767 17.3051C4.72683 17.9067 4.13751 15.9668 4.13751 15.9668C3.68324 14.8128 3.0264 14.5058 3.0264 14.5058C2.11786 13.8858 3.09392 13.8981 3.09392 13.8981C4.09454 13.9718 4.62861 14.9294 4.62861 14.9294C5.51872 16.4579 6.96746 16.016 7.53837 15.7581C7.63045 15.1136 7.88827 14.6716 8.17066 14.4199C5.94843 14.1682 3.61571 13.3088 3.61571 9.47821C3.61571 8.38551 4.00246 7.4954 4.64702 6.79558C4.54266 6.54389 4.19889 5.52486 4.74524 4.14978C4.74524 4.14978 5.58625 3.87968 7.4954 5.17495C8.29343 4.95396 9.14672 4.84346 10 4.83732C10.8471 4.83732 11.7066 4.95396 12.5046 5.17495C14.4137 3.87968 15.2548 4.14978 15.2548 4.14978C15.8011 5.52486 15.4573 6.54389 15.353 6.79558C15.9914 7.4954 16.3781 8.38551 16.3781 9.47821C16.3781 13.3211 14.0393 14.1621 11.8109 14.4137C12.167 14.7207 12.4923 15.3346 12.4923 16.2676C12.4923 17.6059 12.48 18.6802 12.48 19.0117C12.48 19.2818 12.6581 19.5887 13.1676 19.4905C17.1393 18.1645 20 14.4199 20 10.0061C20 4.47514 15.5249 0 10 0Z" fill="currentColor"/></svg>
                        </a>
                        <a class="social-link" href="https://discord.gg/aptosnetwork" target="_blank" rel="noopener noreferrer" title="Discord">
                          <svg width="100%" height="100%" viewBox="0 0 71 55" fill="none" xmlns="http://www.w3.org/2000/svg"><g clip-path="url(#a)"><path d="M60.105 4.898A58.55 58.55 0 0 0 45.653.415a.22.22 0 0 0-.233.11 40.784 40.784 0 0 0-1.8 3.697c-5.456-.817-10.886-.817-16.23 0-.485-1.164-1.201-2.587-1.828-3.697a.228.228 0 0 0-.233-.11 58.386 58.386 0 0 0-14.451 4.483.207.207 0 0 0-.095.082C1.578 18.73-.944 32.144.293 45.39a.244.244 0 0 0 .093.167c6.073 4.46 11.955 7.167 17.729 8.962a.23.23 0 0 0 .249-.082 42.08 42.08 0 0 0 3.627-5.9.225.225 0 0 0-.123-.312 38.772 38.772 0 0 1-5.539-2.64.228.228 0 0 1-.022-.378 31.17 31.17 0 0 0 1.1-.862.22.22 0 0 1 .23-.03c11.619 5.304 24.198 5.304 35.68 0a.219.219 0 0 1 .233.027c.356.293.728.586 1.103.865a.228.228 0 0 1-.02.378 36.384 36.384 0 0 1-5.54 2.637.227.227 0 0 0-.121.315 47.249 47.249 0 0 0 3.624 5.897.225.225 0 0 0 .249.084c5.801-1.794 11.684-4.502 17.757-8.961a.228.228 0 0 0 .092-.164c1.48-15.315-2.48-28.618-10.497-40.412a.18.18 0 0 0-.093-.084Zm-36.38 32.427c-3.497 0-6.38-3.211-6.38-7.156 0-3.944 2.827-7.156 6.38-7.156 3.583 0 6.438 3.24 6.382 7.156 0 3.945-2.827 7.156-6.381 7.156Zm23.593 0c-3.498 0-6.38-3.211-6.38-7.156 0-3.944 2.826-7.156 6.38-7.156 3.582 0 6.437 3.24 6.38 7.156 0 3.945-2.798 7.156-6.38 7.156Z" fill="currentColor"/></g><defs><clipPath id="a"><path fill="currentColor" d="M0 0h71v55H0z"/></clipPath></defs></svg>
                        </a>
                        <a class="social-link" href="https://twitter.com/Aptos" target="_blank" rel="noopener noreferrer" title="Twitter">
                          <svg width="100%" height="100%" viewBox="0 0 22 17" fill="none" xmlns="http://www.w3.org/2000/svg"><path fill-rule="evenodd" clip-rule="evenodd" d="M22 2.013a9.395 9.395 0 0 1-2.593.676A4.348 4.348 0 0 0 21.392.314a9.341 9.341 0 0 1-2.866 1.042A4.62 4.62 0 0 0 15.232 0c-2.493 0-4.514 1.922-4.514 4.292 0 .336.04.664.117.978C7.083 5.09 3.758 3.382 1.532.786A4.115 4.115 0 0 0 .92 2.944c0 1.489.796 2.802 2.007 3.571A4.669 4.669 0 0 1 .884 5.98v.053c0 2.08 1.555 3.815 3.62 4.209a4.744 4.744 0 0 1-2.038.074c.574 1.705 2.241 2.945 4.216 2.98a9.358 9.358 0 0 1-5.605 1.837c-.365 0-.724-.02-1.077-.06A13.257 13.257 0 0 0 6.918 17c8.303 0 12.843-6.54 12.843-12.21 0-.187-.004-.372-.013-.556A8.929 8.929 0 0 0 22 2.013Z" fill="currentColor"/></svg>
                        </a>
                    </nav>
                  </p>
              </li></ul></div></div></div></footer></div>
</body>
</html>